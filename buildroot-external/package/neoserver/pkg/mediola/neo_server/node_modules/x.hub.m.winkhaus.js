function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},_typeof(o);}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key);}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.");}return(hint==="string"?String:Number)(input);}var x=x||{};x.hub=x.hub||{},x.hub.m=x.hub.m||{},x.hub.m.winkhaus=x.hub.m.winkhaus||{},x.hub.m.winkhaus.MODULE=require("xnm.aio.winkhaus.js"),x.hub.m.winkhaus.Handler=function(){var e=function e(){};function t(e){var t=e?e.address:null,n=e?e.subtype:null,r=e?e.password:null,u=e?e.user:null;t||o("no address"),n||o("no deviceType"),r||o("no pass"),u||o("no user");}function o(e){throw err=new Error(e),err.code="000000",err;}return e.prototype.init=function(e){e&&e();},e.prototype.getSystems=function(){return["winkhaus"];},e.prototype.executeCommandV6=function(e,o,n,r){try{t(e);}catch(e){r&&r(e);}n.id&&delete n.id,"mode"==n.command&&(n.command=n.value,delete n.value),new x.hub.m.winkhaus.Client(e).doRequest("POST","/api/v1/control",null,JSON.stringify(n),r);},e.prototype.getStatesV6=function(e,o,n){try{t(e);}catch(e){n&&n(e);}new x.hub.m.winkhaus.Client(e).doRequest("GET","/api/v1/getStates",null,null,n);},e;}(),"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new x.hub.m.winkhaus.Handler()),x.hub.m.winkhaus.Client=/*#__PURE__*/function(){function _class(e){_classCallCheck(this,_class);this.REQUESTS_TIMEOUT_MS=2e4,this._logger=require("x.logger.js").getLogger("WhClient"),this.device=e;}_createClass(_class,[{key:"doRequest",value:function doRequest(e,t,o,n,r){var u="Basic ".concat(new Buffer("".concat(this.device.user,":").concat(this.device.password)).toString("base64")),s={host:this.device.address,port:this.device.port,path:t,method:e,timeout:this.REQUESTS_TIMEOUT_MS,headers:{Connection:"close","Content-Type":"application/json",Authorization:u},rejectUnauthorized:!1};if(o)for(var i in o)o.hasOwnProperty(i)&&(s.headers[i]=o[i]);n&&n.length&&(s.headers["Content-Length"]=n.length);var a=require("https"),d=this,l=r,h=a.request(s,function(e){e.setEncoding("utf-8");var t="";e.on("data",function(e){t+=e;}),e.on("end",function(){d._logger.log("debug","request on ".concat(s.path," ==> receive code: ").concat(e.statusCode)),e.statusCode>299&&d._logger.log("debug","response:"+t);try{(t=JSON.parse(t)).XC_SUC&&(t=t.XC_SUC),t.XC_ERR&&(t=t.XC_ERR);}catch(e){}l&&(l(null,t,e),l=null);});});h.on&&h.on("error",function(e){d._logger.log("error","do request error:"+e.message),l&&(l(e),l=null);}),h.setTimeout&&h.setTimeout(this.REQUESTS_TIMEOUT_MS,function(){d._logger.log("error","do request timeout"),h.abort(),l&&(l(new Error("timeout")),l=null);}),n&&(this._logger.log("debug","request body: "+n),h.write(n)),h.end();}}]);return _class;}();