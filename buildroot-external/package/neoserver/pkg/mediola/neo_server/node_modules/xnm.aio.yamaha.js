var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,a,c){b instanceof String&&(b=String(b));for(var d=b.length,e=0;e<d;e++){var f=b[e];if(a.call(c,f,e,b))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in c||(c[e]={});c=c[e]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");var xnm=xnm||{};xnm.aio=xnm.aio||{};xnm.aio.yamaha=xnm.aio.yamaha||{};
xnm.aio.yamaha.AVR=function(){var b=function(a,c,d,e,b){this._logger=require("x.logger.js").getLogger("xnm.aio.yamaha.AVR");this.ip=a;this.port=c;this.port||(this.port="80");this.uuid=d;this.name=e;this.model=b;this.timeout=3E3;this.CommandHandler=null};b.prototype.audioModes="2ch Stereo;5ch Stereo;Surround Decoder;Standard;Spectacle;Sci-Fi;Adventure;Drama;Mono Movie;Sports;Action Game;Roleplaying Game;Hall in Munich;Hall in Vienna;Chamber;Cellar Club;The Roxy Theatre;The Bottom Line;Music Video".split(";");b.prototype.videoModes=
"HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link".split(";");b.prototype.executeCommandCreator=function(a,c,d){if(c&&c.value)if("openNative"==c.value)window&&window.XC&&window.XC.callHost&&window.XCHost.getType&&("iOS"==window.XCHost.getType()?window.XC.callHost("SYSTEM","startApp",{scheme:"jp.co.yamaha.avkk.avcontroller://"}):"Android"==window.XCHost.getType()&&window.XC.callHost("SYSTEM",
"startApp",{scheme:"com.yamaha.av.avcontroller"})),d&&d();else{a="";c.path&&c.path[0]&&"global"!=c.path[0]&&(a=c.path[0]+":");var e=a+c.value;if("sleep"==c.value){if(!c.ext){d&&d(Error("command sleep ext format invalid"));return}e+=c.ext.replace(/min/g,"")}else if("setInput"==c.value){if(!c.ext){d&&d(Error("command setInput ext format invalid"));return}e=a+c.ext}else if("audioMode"==c.value){if(!c.ext){d&&d(Error("command audioMode ext format invalid"));return}e=a+c.ext}else if("setTo"==c.value){if(null==
c.ext||"undefined"==typeof c.ext){d&&d(Error("command setTo ext format invalid"));return}e+=c.ext}else if("dlgLevel"==c.value){if(null==c.ext||"undefined"==typeof c.ext){d&&d(Error("command dlgLevel ext format invalid"));return}e+=c.ext}else if("setVideoPreset"==c.value){if(null==c.ext||"undefined"==typeof c.ext){d&&d(Error("command setVideoPreset ext format invalid"));return}e+=c.ext}else if("customCMD"==c.value){if(!c.ext){d&&d(Error("command customCMD ext format invalid"));return}e=a+c.ext}if(c.path&&
c.path[0]&&"tuner"==c.path[0]&&(e=c.value,"tunerPreset"==c.value)){if(null==c.ext||"undefined"==typeof c.ext){d&&d(Error("command tunerPreset ext format invalid"));return}e="tuner"+c.ext}this.executeCommand(e,function(a){if(a)d&&d(a);else{if(c.path&&c.path[0]&&"mainzone"==c.path[0]){if("on"==c.value||"off"==c.value||"toggle"==c.value){setTimeout(function(){d&&d()},1E3);return}if("setTo"==c.value||"volumeUp"==c.value||"volumeDown"==c.value){setTimeout(function(){d&&d()},10);return}}d&&d()}})}else d&&
d(Error("command json format invalid"))};b.prototype.getStatesCreator=function(a,c,d){a=[];for(var e=0;e<c.length;e++)if(c[e]&&c[e].status&&c[e].status.path&&c[e].status.path[0]){var b=0;switch(c[e].status.path[0]){case "mainzone":b=1;break;case "zone2":b=2;break;case "zone3":b=3;break;case "zone4":b=4}b&&-1==a.indexOf(b)&&a.push(b)}this.getStates(a,function(a,e){a=[];for(var b=0;b<c.length;b++)if(c[b]&&c[b].id){var f="?";if(c[b].status&&c[b].status.value){var g="";c[b].status.path&&c[b].status.path[0]&&
"global"!=c[b].status.path[0]&&(g=c[b].status.path[0]);var h=c[b].status.value;e&&g&&e[g]&&e[g][h]&&(f=e[g][h])}a.push({id:c[b].id,status:f})}d&&d(null,a)})};b.prototype._doRequest=function(a,c,d){a='<?xml version="1.0" encoding="utf-8"?><YAMAHA_AV cmd="'+a+'">'+(c+"</YAMAHA_AV>");var e=this;c="http://"+this.ip+":"+this.port+"/YamahaRemoteControl/ctrl";this._logger.log("trace","send data:"+a);var b=d;$.ajax({url:c,type:"POST",timeout:this.timeout,data:a,dataType:"text",cache:!0,headers:{"Content-Length":a.length},
success:function(a){e._logger.log("trace","http request success:"+a);b&&(b(null,a),b=null)},error:function(a,c){a="http request error:"+(a?a.status:"0")+"-"+c;e._logger.log("trace",a);b&&(b(Error(a)),b=null)}})};b.prototype._getStateValue=function(a,c,d){var b=null;a=a.find(c);0<a.length&&(b=$(a[0]).text());b&&d&&(b=b.toLowerCase());return b};b.prototype._parseStates=function(a,c){var d={};d.power=this._getStateValue(a,"Power_Control Power",!0);"standby"==d.power&&(d.power="off");d.sleep=this._getStateValue(a,
"Power_Control Sleep",!0);d.mute=this._getStateValue(a,"Volume Mute",!0);var b=this._getStateValue(a,"Volume Lvl Val");d.volume=b?(parseFloat(b)/10).toFixed(1):null;d.input=this._getStateValue(a,"Input Input_Sel");"zone2"!=c&&"zone3"!=c&&"zone4"!=c&&(d.mode=this._getStateValue(a,"Surround Program_Sel Current Sound_Program"),d.enhancer=this._getStateValue(a,"Surround Program_Sel Current Enhancer",!0),d.straight=this._getStateValue(a,"Surround Program_Sel Current Straight",!0),d.direct=this._getStateValue(a,
"Sound_Video Pure_Direct Mode",!0),d.bass=this._getStateValue(a,"Sound_Video Extra_Bass",!0),"auto"==d.bass&&(d.bass="on"),d.ypao_volume=this._getStateValue(a,"Sound_Video YPAO_Volume",!0),"auto"==d.ypao_volume&&(d.ypao_volume="on"),d.dlgLevel=this._getStateValue(a,"Sound_Video Dialogue_Adjust Dialogue_Lvl"),d.videoPreset=this._getStateValue(a,"Sound_Video HDMI Video Preset_Sel Current",!0),d.videoPreset&&(d.videoPreset=d.videoPreset.replace("preset ","")));return d};b.prototype.getStates=function(a,
c){a&&0!=a.length||(a=[1]);var d={},b=0,f=this,g=function(e,k){var h=a[b];!e&&k&&(1==h?d.mainzone=k.mainzone:2==h?d.zone2=k.zone2:3==h?d.zone3=k.zone3:4==h&&(d.zone4=k.zone4));b++;b<a.length?f._getZoneStates(a[b],g):c&&c(null,d)};this._getZoneStates(a[b],g)};b.prototype._getZoneStates=function(a,c){var d=this;if(1==a){var b="Main_Zone";var f="mainzone"}else 2==a?(b="Zone_2",f="zone2"):3==a?(b="Zone_3",f="zone3"):4==a&&(b="Zone_4",f="zone4");this._doRequest("GET","<"+b+"><Basic_Status>GetParam</Basic_Status></"+
b+">",function(a,b){if(a)c&&c(a);else try{var e=$($.parseXML(b));if(e){var g=e.find("Basic_Status");if(!g||0>=g.length)c&&c(Error(f+" status reponse has no basic status tag"));else{var h=$(g[0]);a={};a[f]=d._parseStates(h,f);c&&c(null,a)}}else c&&c(Error(f+" status reponse invalid"))}catch(l){c&&c(l)}})};b.prototype.executeCommand=function(a,c){var d=!0,b=null,f=a.indexOf(":");0<f&&(b=a.substr(0,f),a=a.substr(f+1));"on"==a?a="<Power_Control><Power>On</Power></Power_Control>":"off"==a||"standby"==
a?a="<Power_Control><Power>Standby</Power></Power_Control>":"toggle"==a?a="<Power_Control><Power>On/Standby</Power></Power_Control>":"mute"==a?a="<Volume><Mute>On</Mute></Volume>":"unmute"==a?a="<Volume><Mute>Off</Mute></Volume>":"toggleMute"==a?a="<Volume><Mute>On/Off</Mute></Volume>":"volumeDown"==a?a="<Volume><Lvl><Val>Down</Val><Exp></Exp><Unit></Unit></Lvl></Volume>":"volumeUp"==a?a="<Volume><Lvl><Val>Up</Val><Exp></Exp><Unit></Unit></Lvl></Volume>":"enhancerOn"==a?a="<Surround><Program_Sel><Current><Enhancer>On</Enhancer></Current></Program_Sel></Surround>":
"enhancerOff"==a?a="<Surround><Program_Sel><Current><Enhancer>Off</Enhancer></Current></Program_Sel></Surround>":"directOn"==a?a="<Sound_Video><Pure_Direct><Mode>On</Mode></Pure_Direct></Sound_Video>":"directOff"==a?a="<Sound_Video><Pure_Direct><Mode>Off</Mode></Pure_Direct></Sound_Video>":"extraBassOn"==a?a="<Sound_Video><Extra_Bass>Auto</Extra_Bass></Sound_Video>":"extraBassOff"==a?a="<Sound_Video><Extra_Bass>Off</Extra_Bass></Sound_Video>":"straightOn"==a?a="<Surround><Program_Sel><Current><Straight>On</Straight></Current></Program_Sel></Surround>":
"straightOff"==a?a="<Surround><Program_Sel><Current><Straight>Off</Straight></Current></Program_Sel></Surround>":"Scene1"==a?a="<Scene><Scene_Sel>Scene 1</Scene_Sel></Scene>":"Scene2"==a?a="<Scene><Scene_Sel>Scene 2</Scene_Sel></Scene>":"Scene3"==a?a="<Scene><Scene_Sel>Scene 3</Scene_Sel></Scene>":"Scene4"==a?a="<Scene><Scene_Sel>Scene 4</Scene_Sel></Scene>":"play"==a?a="<Play_Control><Playback>Play</Playback></Play_Control>":"pause"==a?a="<Play_Control><Playback>Pause</Playback></Play_Control>":
"stop"==a?a="<Play_Control><Playback>Stop</Playback></Play_Control>":"previous"==a?a="<Play_Control><Playback>Skip Rev</Playback></Play_Control>":"next"==a?a="<Play_Control><Playback>Skip Fwd</Playback></Play_Control>":"up"==a?a="<Cursor_Control><Cursor>Up</Cursor></Cursor_Control>":"down"==a?a="<Cursor_Control><Cursor>Down</Cursor></Cursor_Control>":"left"==a?a="<Cursor_Control><Cursor>Left</Cursor></Cursor_Control>":"right"==a?a="<Cursor_Control><Cursor>Right</Cursor></Cursor_Control>":"enter"==
a?a="<Cursor_Control><Cursor>Sel</Cursor></Cursor_Control>":"return"==a?a="<Cursor_Control><Cursor>Return</Cursor></Cursor_Control>":0==a.indexOf("sleep")?(a=a.replace(/sleep/g,"").toLowerCase(),a="off"==a?"<Power_Control><Sleep>Off</Sleep></Power_Control>":"<Power_Control><Sleep>"+a+" min</Sleep></Power_Control>"):0==a.indexOf("dlgLevel")?(a=a.replace(/dlgLevel/g,"").toLowerCase(),a="<Sound_Video><Dialogue_Adjust><Dialogue_Lvl>"+a+"</Dialogue_Lvl></Dialogue_Adjust></Sound_Video>"):0==a.indexOf("setVideoPreset")?
(a=a.replace(/setVideoPreset/g,"").toLowerCase(),b="system",a="<Sound_Video><HDMI><Video><Presetl_Sel><Current>"+a+"</Current></Presetl_Sel></Video></HDMI></Sound_Video>"):0==a.indexOf("tuner")?(d=!1,a=a.replace(/tuner/g,""),a="Up"==a?"<Tuner><Play_Control><Preset><Preset_Sel>Up</Preset_Sel></Preset></Play_Control></Tuner>":"Down"==a?"<Tuner><Play_Control><Preset><Preset_Sel>Down</Preset_Sel></Preset></Play_Control></Tuner>":"AM"==a?"<Tuner><Play_Control><Tuning><Band>AM</Band></Tuning></Play_Control></Tuner>":
"FM"==a?"<Tuner><Play_Control><Tuning><Band>FM</Band></Tuning></Play_Control></Tuner>":"<Tuner><Play_Control><Preset><Preset_Sel>"+a+"</Preset_Sel></Preset></Play_Control></Tuner>"):-1!=this.videoModes.indexOf(a)?a="<Input><Input_Sel>"+a+"</Input_Sel></Input>":-1!=this.audioModes.indexOf(a)?a="Straight"==a?"<Surround><Program_Sel><Current><Straight>On</Straight></Current></Program_Sel></Surround>":"<Surround><Program_Sel><Current><Sound_Program>"+a+"</Sound_Program></Current></Program_Sel></Surround>":
0==a.indexOf("setTo")||/^-?\d*\.{0,1}\d+$/.test(a)?(0==a.indexOf("setTo")&&(a=a.replace(/setTo/g,"")),a=a.replace(/%/g,""),a=Math.round(10*parseFloat(a)),-805>a?a=-805:165<a&&(a=165),a="<Volume><Lvl><Val>"+a+"</Val><Exp>1</Exp><Unit>dB</Unit></Lvl></Volume>"):d=!1;d&&(a="system"==b?"<System>"+a+"</System>":"zone2"==b?"<Zone_2>"+a+"</Zone_2>":"zone3"==b?"<Zone_3>"+a+"</Zone_3>":"zone2"==b?"<Zone_4>"+a+"</Zone_4>":"<Main_Zone>"+a+"</Main_Zone>");this._doRequest("PUT",a,c)};b.prototype.getStateValues=
function(a,c){return c};b.prototype.toJSON=function(){var a={sys:xnm.aio.yamaha.DM.SYS,type:"avr",ip:this.ip,port:this.port,uuid:this.uuid,model:this.model};this.name&&(a.name=this.name);return a};b.prototype.equalsTo=function(a){return a&&a instanceof b?this.ip==a.ip&&this.port==a.port:!1};b.DEVICE_1_ZONE="RX-V477 RX-V475 RX-V500D RX-V473 HTR-4067 HTR-5066 HTR-4066 HTR-5065 HTR-4065".split(" ");b.DEVICE_2_ZONE="RX-S600D RX-S600 RX-A1040 RX-A840 RX-A740 RX-A1030 RX-A830 RX-A730 RX-A1020 RX-A820 RX-A720 RX-A1010 RX-A810 RX-A710 RX-A1000 RX-V1077 RX-V777 RX-V677 RX-V577 RX-V1075 RX-V775 RX-V675 RX-V575 RX-V1073 RX-V773 RX-V673 RX-V573 RX-V1071 RX-V871 RX-V771 RX-V671 RX-V1067 RX-V867 HTR-6067 HTR-5067 HTR-6066 TSR-6750 HTR-7065 HTR-6065 HTR-6064 HTR-9063 HTR-8063".split(" ");
b.DEVICE_3_ZONE="RX-A2020 RX-A2010 RX-A2000 RX-V2073 RX-V2071 RX-V2067 RX-V2065 RX-V3900 DSP-AX3900 HTR-6295".split(" ");b.DEVICE_4_ZONE="CX-A5000 RX-A3040 RX-A2040 RX-A3030 RX-A2030 RX-A3020 RX-A3010 RX-A3000 RX-V3077 RX-V2077 RX-V3075 RX-V2075 RX-V3073 RX-V3071 RX-V3067 RX-Z7 DSP-Z7".split(" ");b.parseJSON=function(a){return a.ip?new b(a.ip,a.port,a.uuid,a.name,a.model):null};b.getZoneCount=function(a){return a&&a.model?-1!=b.DEVICE_4_ZONE.indexOf(a.model)?4:-1!=b.DEVICE_3_ZONE.indexOf(a.model)?
3:-1!=b.DEVICE_2_ZONE.indexOf(a.model)?2:1:1};return b}();
xnm.aio.yamaha.DM=function(){var b=function(a,d){this.code=a;this.message=d;this.stack=Error().stack};b.prototype=Error();b.prototype.name="YamahaDMError";b.prototype.code=0;b.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6};var a={avr:{command:[{type:"root",name:"global",value:"global",children:[{type:"string",name:"custom command",ref:{value:"customCMD",ext:"%s"}},{type:"enum",name:"open yamaha AV Controller",ref:{value:"openNative"}}]},{type:"root",name:"tuner",
value:"tuner",children:[{type:"enum",name:"preset up",ref:{value:"tunerUp"}},{type:"enum",name:"preset down",ref:{value:"tunerDown"}},{type:"enum",name:"AM",ref:{value:"tunerAM"}},{type:"enum",name:"FM",ref:{value:"tunerFM"}},{type:"int",name:"set preset",ref:{value:"tunerPreset",ext:"%d",extMeta:"1-40",scale:"1"}}]},{type:"root",name:"main zone",value:"mainzone",children:[{type:"enum",name:"power on",ref:{value:"on"}},{type:"enum",name:"power off",ref:{value:"off"}},{type:"enum",name:"toggle power",
ref:{value:"toggle"}},{type:"enum",name:"mute",ref:{value:"mute"}},{type:"enum",name:"unmute",ref:{value:"unmute"}},{type:"enum",name:"toggle mute",ref:{value:"toggleMute"}},{type:"enum",name:"enhancer on",ref:{value:"enhancerOn"}},{type:"enum",name:"enhancer off",ref:{value:"enhancerOff"}},{type:"enum",name:"direct on",ref:{value:"directOn"}},{type:"enum",name:"direct off",ref:{value:"directOff"}},{type:"enum",name:"extra bass on",ref:{value:"extraBassOn"}},{type:"enum",name:"extra bass off",ref:{value:"extraBassOff"}},
{type:"enum",name:"straight on",ref:{value:"straightOn"}},{type:"enum",name:"straight off",ref:{value:"straightOff"}},{type:"enum",name:"scene 1",ref:{value:"Scene1"}},{type:"enum",name:"scene 2",ref:{value:"Scene2"}},{type:"enum",name:"scene 3",ref:{value:"Scene3"}},{type:"enum",name:"scene 4",ref:{value:"Scene4"}},{type:"enum",name:"sleep",ref:{value:"sleep",ext:"%e",extMeta:["30min","60min","90min","120min","off"]}},{type:"enum",name:"set input",ref:{value:"setInput",ext:"%e",extMeta:"HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link".split(";")}},
{type:"enum",name:"set dsp mode",ref:{value:"audioMode",ext:"%e",extMeta:"2ch Stereo;5ch Stereo;Surround Decoder;Standard;Spectacle;Sci-Fi;Adventure;Drama;Mono Movie;Sports;Action Game;Roleplaying Game;Hall in Munich;Hall in Vienna;Chamber;Cellar Club;The Roxy Theatre;The Bottom Line;Music Video".split(";")}},{type:"enum",name:"volume up",ref:{value:"volumeUp"}},{type:"enum",name:"volume down",ref:{value:"volumeDown"}},{type:"float",name:"volume to",ref:{value:"setTo",unit:"db",ext:"%f",extMeta:"-80.5-16.5",
scale:"0.5"}},{type:"enum",name:"play",ref:{value:"play"}},{type:"enum",name:"pause",ref:{value:"pause"}},{type:"enum",name:"stop",ref:{value:"stop"}},{type:"enum",name:"previous",ref:{value:"previous"}},{type:"enum",name:"next",ref:{value:"next"}},{type:"enum",name:"up",ref:{value:"up"}},{type:"enum",name:"down",ref:{value:"down"}},{type:"enum",name:"left",ref:{value:"left"}},{type:"enum",name:"right",ref:{value:"right"}},{type:"enum",name:"enter",ref:{value:"enter"}},{type:"enum",name:"return",
ref:{value:"return"}}]}],status:[{type:"root",name:"main zone",value:"mainzone",children:[{type:"float",name:"volume",ref:{value:"volume",unit:"db",extMeta:"-80.5-16.5",scale:"0.5"}},{type:"enum",name:"power",ref:{value:"power",options:["on","off"]}},{type:"enum",name:"mute",ref:{value:"mute",options:["on","off"]}},{type:"enum",name:"sleep",ref:{value:"sleep",options:["30min","60min","90min","120min","off"]}},{type:"enum",name:"input",ref:{value:"input",options:"HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link".split(";")}},
{type:"enum",name:"dsp mode",ref:{value:"mode",options:"2ch Stereo;5ch Stereo;Surround Decoder;Standard;Spectacle;Sci-Fi;Adventure;Drama;Mono Movie;Sports;Action Game;Roleplaying Game;Hall in Munich;Hall in Vienna;Chamber;Cellar Club;The Roxy Theatre;The Bottom Line;Music Video;Straight".split(";")}},{type:"enum",name:"enhancer",ref:{value:"enhancer",options:["on","off"]}},{type:"enum",name:"straight",ref:{value:"straight",options:["on","off"]}},{type:"enum",name:"extra bass",ref:{value:"bass",options:["on",
"off"]}},{type:"enum",name:"direct",ref:{value:"direct",options:["on","off"]}}]}]},avr_zone_template:{command:[{type:"root",name:"@zone N",value:"zoneN",children:[{type:"enum",name:"power on",ref:{value:"on"}},{type:"enum",name:"power off",ref:{value:"off"}},{type:"enum",name:"toggle power",ref:{value:"toggle"}},{type:"enum",name:"mute",ref:{value:"mute"}},{type:"enum",name:"unmute",ref:{value:"unmute"}},{type:"enum",name:"toggle mute",ref:{value:"toggleMute"}},{type:"enum",name:"sleep",ref:{value:"sleep",
ext:"%e",extMeta:["30min","60min","90min","120min","off"]}},{type:"enum",name:"set input",ref:{value:"setInput",ext:"%e",extMeta:"HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link".split(";")}},{type:"enum",name:"volume up",ref:{value:"volumeUp"}},{type:"enum",name:"volume down",ref:{value:"volumeDown"}},{type:"float",name:"volume to",ref:{value:"setTo",unit:"db",ext:"%f",extMeta:"-80.5-16.5",
scale:"0.5"}},{type:"enum",name:"play",ref:{value:"play"}},{type:"enum",name:"pause",ref:{value:"pause"}},{type:"enum",name:"stop",ref:{value:"stop"}},{type:"enum",name:"previous",ref:{value:"previous"}},{type:"enum",name:"next",ref:{value:"next"}},{type:"enum",name:"up",ref:{value:"up"}},{type:"enum",name:"down",ref:{value:"down"}},{type:"enum",name:"left",ref:{value:"left"}},{type:"enum",name:"right",ref:{value:"right"}},{type:"enum",name:"enter",ref:{value:"enter"}},{type:"enum",name:"return",
ref:{value:"return"}}]}],status:[{type:"root",name:"zone N",value:"zoneN",children:[{type:"float",name:"volume",ref:{value:"volume",unit:"db",extMeta:"-80.5-16.5",scale:"0.5"}},{type:"enum",name:"power",ref:{value:"power",options:["on","off"]}},{type:"enum",name:"mute",ref:{value:"mute",options:["on","off"]}},{type:"enum",name:"sleep",ref:{value:"sleep",options:["30min","60min","90min","120min","off"]}},{type:"enum",name:"input",ref:{value:"input",options:"HDMI1;HDMI2;HDMI3;HDMI4;HDMI5;HDMI6;AUDIO1;AUDIO2;AV1;AV2;AV3;AV4;AV5;AV6;TUNER;USB;NET RADIO;Bluetooth;AUX;V-AUX;NET;SERVER;AirPlay;JUKE;Spotify;MusicCast Link".split(";")}}]}]},
"avr_RX-A3040":{command:[{type:"root",name:"main zone",value:"mainzone",children:[{type:"int",name:"dialogue level",ref:{value:"dlgLevel",ext:"%d",extMeta:"0-3"}},{type:"enum",name:"set HDMI video preset",ref:{value:"setVideoPreset",ext:"%e",extMeta:"123456".split("")}}]}],status:[{type:"root",name:"main zone",value:"mainzone",children:[{type:"int",name:"dialogue level",ref:{value:"dlgLevel",ext:"%d",extMeta:"0-3"}},{type:"enum",name:"HDMI video preset",ref:{value:"videoPreset",options:"123456".split("")}}]}]}};
return{SYS:"yamaha",getIPDeviceType:function(){return[{sys:this.SYS,name:"Yamaha AV Receiver",type:"avr"}]},createDevice:function(a,d,e){d=b.ERROR_CODE;a?a.ip?e(null,a):e(new b(d.INVALID,"ip is invalid")):e(new b(d.INVALID,"info is invalid"))},updateDevice:function(a,d,e){d=b.ERROR_CODE;a?a.ip?e(null,a):e(new b(d.INVALID,"ip is invalid")):e(new b(d.INVALID,"info is invalid"))},deleteDevice:function(a,d,b){b()},applyUIFilter:function(a,d,b){var c=function(a,b,d){var e=[];a.forEach(function(a){if("root"==
a.type){a=JSON.parse(JSON.stringify(a));var f=c(a.children,b,d);f&&0<f.length&&(a.children=f,e.push(a))}else{f=d.elems;if("*"==f)f=!0;else{for(var g=!1,h=0;h<f.length;h++)if(f[h]==a.type){g=!0;break}f=g}f&&(a=JSON.parse(JSON.stringify(a)),e.push(a))}});return e},e=function(a,d){var e=[],f=xnm.aio.yamaha.DM.getCommandStatusMap(a,b);if(f){var g=[];switch(d.catagory){case "command":f.command&&(g=c(f.command,a,d));break;case "status":f.status&&(g=c(f.status,a,d))}e=e.concat(g)}return e};if(!a.sys)return null;
var h=JSON.parse(JSON.stringify(a)),k=null;switch(d.catagory){case "command":k=e(a,d);h.command=k;break;case "status":k=e(a,d);h.status=k;break;default:return null}return k&&0!=k.length?h:null},getCommandStatusMap:function(c){if(!c||!c.type)return null;var d=a[c.type];if(!d)return null;d=JSON.parse(JSON.stringify(d));var b=xnm.aio.yamaha.AVR.getZoneCount(c);if(1<b)for(var f=2;f<=b;f++){var g=JSON.parse(JSON.stringify(a.avr_zone_template));g.command[0].name="zone "+f;g.command[0].value="zone"+f;g.status[0].name=
"zone "+f;g.status[0].value="zone"+f;d.command=d.command.concat(g.command);d.status=d.status.concat(g.status)}c.model&&a[c.type+"_"+c.model]&&((c=a[c.type+"_"+c.model])&&(c=JSON.parse(JSON.stringify(c))),c&&c.command&&c.command.forEach(function(a){if(a&&"root"==a.type){var c;a:{if((c=a.value)&&d&&d.command)for(var b=0;b<d.command.length;b++)if(d.command[b]&&"root"==d.command[b].type&&d.command[b].value==c){c=d.command[b];break a}c=null}c?(c.children||(c.children=[]),c.children=c.children.concat(a.children)):
d.command.push(a)}else d.command.push(a)}),c&&c.status&&c.status.forEach(function(a){if(a&&"root"==a.type){var c;a:{if((c=a.value)&&d&&d.status)for(var b=0;b<d.status.length;b++)if(d.status[b]&&"root"==d.status[b].type&&d.status[b].value==c){c=d.status[b];break a}c=null}c?(c.children||(c.children=[]),c.children=c.children.concat(a.children)):d.status.push(a)}else d.status.push(a)}));return d}}}();
xnm.aio.yamaha.Handler=function(){var b=function(){this.detectedAVRs={}};b.prototype.devicemanager=xnm.aio.yamaha.DM;b.prototype.AVR=xnm.aio.yamaha.AVR;b.prototype.registModule=function(a){a.register(this.devicemanager.SYS,"yamaha")};b.prototype.resolveDevice=function(a){if(!a)return null;switch(a.type){case "avr":return xnm.aio.yamaha.AVR.parseJSON(a);default:return null}};b.prototype.getDeviceCommands=function(a,c){a=(a=this.devicemanager.applyUIFilter(a,{catagory:"command",elems:"*"}))?a.command:
[];c&&c(null,a)};b.prototype.getDeviceStatus=function(a,c){a=(a=this.devicemanager.applyUIFilter(a,{catagory:"status",elems:"*"}))?a.status:[];c&&c(null,a)};b.prototype.doCommand=function(a,c,b){var d=this.resolveDevice(a);d?d.executeCommandCreator(a,c,function(a){b&&b(a)}):b&&b(Error("device json format invalid"))};b.prototype.doStatus=function(a,c,b,e){var d=this.resolveDevice(c);d?d.getStatesCreator(null,[{id:a,device:c,status:b}],function(a,c){a?e&&e(a):e&&e(null,c[0])}):e&&e(Error("device json format invalid"))};
b.prototype.discoverDevices=function(a){var c=function(a){if(!a)return a;var c;for(c=0;c<xnm.aio.yamaha.AVR.DEVICE_1_ZONE.length;c++){var b=xnm.aio.yamaha.AVR.DEVICE_1_ZONE[c];if(-1!=a.indexOf(b))return b}for(c=0;c<xnm.aio.yamaha.AVR.DEVICE_2_ZONE.length;c++)if(b=xnm.aio.yamaha.AVR.DEVICE_2_ZONE[c],-1!=a.indexOf(b))return b;for(c=0;c<xnm.aio.yamaha.AVR.DEVICE_3_ZONE.length;c++)if(b=xnm.aio.yamaha.AVR.DEVICE_3_ZONE[c],-1!=a.indexOf(b))return b;for(c=0;c<xnm.aio.yamaha.AVR.DEVICE_4_ZONE.length;c++)if(b=
xnm.aio.yamaha.AVR.DEVICE_4_ZONE[c],-1!=a.indexOf(b))return b;return a},b=require("x.upnp.js");if(b){var e=this;b.discoverDevicesWithTimeout(3E3,function(b){if(b.manufacturer&&0==b.manufacturer.indexOf("Yamaha")&&"AV Receiver"==b.modelDescription){var d=c(b.modelName);d=new xnm.aio.yamaha.AVR(b.ip,80,b.uuid,b.name,d);e.detectedAVRs["uuid:"+b.uuid]||(e.detectedAVRs["uuid:"+b.uuid]=d);a(d)}})}};b.prototype.discoverWithTimeout=function(a,c){var b={};this.discoverDevices(function(a){a&&a.uuid&&!b[a.uuid]&&
(b[a.uuid]=a)});setTimeout(function(){var a=[],d;for(d in b)b.hasOwnProperty(d)&&a.push(b[d]);c&&c(null,a)},a)};b.prototype.getStateValues=function(a,b){return(new xnm.aio.yamaha.AVR).getStateValues(a.type,b)};b.prototype.getDeviceCommandList=function(a,b,d){return[]};return b}();"undefined"!=typeof module&&null!=module&&(module.exports=new xnm.aio.yamaha.Handler);
