"use strict";var m=m||{};m.aio=m.aio||{},m.aio.infomanager=m.aio.infomanager||{},m.aio.infomanager.Manager=function(){var e=-1,n={},t="info",o=[],i="blocked",r="webservice.mediola.com",s=443,c="/creatorneo/license/getlicensesummary",l="/creatorneo/license/getblocked2";var a=["mcontrol","xs1","cloud_device"],u=["neo","neo2"],f=["aio","hm","hue","harmony","instar","ip","telefunken","konine","contronics","7links","dlink","hama","foscam","edimax","ipsync","wemo","sonos","redeye","itach","irtrans","digitus","dmx4all","easysh","moehlenhoff","internorm","siegenia","miele","rwe","ez","vera","knx","synco","bub","rademacher","max","nueva","osram","netatmo","intertechno","brennenstuhl","spro","milight","aio_upgrade","hm_upgrade",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"ultimate","tado","denon","pioneer","yamaha","onkyo","marantz","doorbird","homewizard","rehau","fritz","qivicon","mobotix","ipcam","netatmo_welcome","yellowstone","samsung","esco","mydlink","orvibo","raumfeld","bose","axis","neoserver","nuki","warema","feller","enocean","zwave","tahoma","fibaro","zigbee","digitalstrom","mystrom","hautau","brelag","hm_ccu3","wir","iobroker","kopp","enoceanip","cloud_device","gealan","nanoleaf","shelly","selve","openhab","bosch","homekit","gira","junghome","somfylocal","eltako_minisafe2","universal_bundle","sus_holder","winkhaus","matterbridge"],d=f.indexOf("ultimate"),h=f.indexOf("universal_bundle"),p=["milight","milightv6","qivicon","rwe","tahoma"],g=["aio_upgrade","hm_ccu3","hm_upgrade","sus_holder","ultimate","bub","ez","miele","synco","vera","bosch","milight","qivicon","rwe","tahoma"],v=["milight","rwe"],y=function y(e){return e.version+":"+("normal"===e.type?0:1)+":"+e.id;},b=function b(e){var n=require("crypto"),t=Buffer.from("fO4gAeDjh4HwO0D8+/9Bfw==","base64"),o=Buffer.from("+ubtPBJR9uejkjXiN6c1Bg==","base64"),i=n.createCipheriv("aes-128-cbc",t,o);i.setAutoPadding(!0);var r=[i.update(e,"utf8")];return r.push(i["final"]()),Buffer.concat(r).toString("base64");},k=function k(e){var n=require("crypto"),t=Buffer.from("fO4gAeDjh4HwO0D8+/9Bfw==","base64"),o=Buffer.from("+ubtPBJR9uejkjXiN6c1Bg==","base64"),i=n.createDecipheriv("aes-128-cbc",t,o);i.setAutoPadding(!0);var r=[i.update(Buffer.from(e,"base64"))];r.push(i["final"]());var s=Buffer.concat(r).toString("utf8");return JSON.parse(s);},_=function _(e,n){var t={"aio@10":{full:0,upgrade:42},"hm@10":{full:1,upgrade:43}};if(n&&e&&0!==n.length)for(var _o in t){var _i=t[_o];if(!_i)continue;var _r=n.indexOf(_o);if(_r<0)continue;var _s=e.indexOf(_i.upgrade);_s>=0?(n.splice(_r,1),e.includes(_i.full)||(e.splice(_s,1),e.push(_i.full))):e.includes(_i.full)&&n.splice(_r,1);}},w=function w(e){var n=[];for(var _t=0;_t<e.length;_t++){var _o2=f.indexOf(e[_t]);-1===_o2||n.includes(_o2)||n.push(_o2);}return n;},O=function O(e,n){var t=e.slice();for(var _o3=0;_o3<n.length;_o3++)e.includes(n[_o3])||t.push(n[_o3]);return t;},I=function I(e,n,t){!function(e){var n=require("https"),t={host:r,port:s,path:l,method:"GET",timeout:2e4,headers:{"User-Agent":"mediola",Connection:"close"}};var o="";var i=n.request(t,function(n){n.setEncoding("utf8"),n.on("data",function(e){o+=e;}),n.on("end",function(){e&&(200==n.statusCode?e(null,o):e(new Error("Request failed: "+o))),e=null;});});"function"==typeof i.on&&i.on("error",function(n){e&&e(n),e=null;}),i.setTimeout&&i.setTimeout(2e4),i.end();}(function(r,s){if(r)t&&t(r);else if(s){try{o=JSON.parse(s);}catch(r){console.error(r);}n&&n.updateBlockedLicenses(o,function(){}),e&&o&&e.save(i,b(JSON.stringify(o))),t&&t();}else t&&t();});},C=function C(e,n,t){var o=require("https");443!=s&&(o=require("http"));var i=2e4;t&&t.timeout&&(i=t.timeout);var l={host:r,port:s,path:c,method:"POST",timeout:i,headers:{"User-Agent":"mediola",Connection:"close"}};m.aio.infomanager.IM._logger.log("trace","try to download info from ".concat(l.host,":").concat(l.port));var a="";var u=o.request(l,function(e){e.setEncoding("utf8"),e.on("data",function(e){a+=e;}),e.on("end",function(){if(200==e.statusCode)m.aio.infomanager.IM._logger.log("trace","download info success"),n&&n(null,a);else{m.aio.infomanager.IM._logger.log("trace","download info failed: ".concat(e.statusCode," : ")+a);var _t2=new Error("request failed: "+a);_t2.code="http",n&&n(_t2);}n=null;});});u.on("error",function(e){e.code="connection",m.aio.infomanager.IM._logger.log("trace","download info error: "+e.stack),n&&n(e),n=null;}),u.setTimeout(i,function(){m.aio.infomanager.IM._logger.log("trace","download info timeout");var e=new Error("HTTP timeout");e.code="timeout",n&&n(e),n=null;}),u.write(e),u.end();},E=function E(e){var n=k(e),t={};var _loop=function _loop(){if(!n.hasOwnProperty(_e))return 1;// continue
var o=n[_e],i={feature:o.feature,blocked:o.blocked,skins:o.skins,sus_info:o.sus_info,sus_flatrate:o.sus_flatrate,codes:{}};if(!i.sus_info.ultimate){var _e2=i.sus_info;if(_e2.universal_bundle)f.forEach(function(n){if(n&&"universal_bundle"!==n&&!g.includes(n))if(_e2[n]){var _t3=_e2[n];_t3.deadline>-1&&_t3.deadline<=_e2.universal_bundle.deadline&&(_e2[n]=_e2.universal_bundle);}else _e2[n]=_e2.universal_bundle;});else if(_e2.sus_holder)for(var _n in _e2)_e2[_n].deadline>-1&&(_e2[_n]=_e2.sus_holder);}if(t[_e]=i,o.codes)for(var _e3 in o.codes){if(!o.codes.hasOwnProperty(_e3))continue;var _n2=o.codes[_e3],_t4={blocked:_n2.blocked};_n2.op&&(_t4.op=k(_n2.op)),i.codes[_e3]=_t4;}};for(var _e in n){if(_loop())continue;}return t;},x=function x(e,o,i){o.trace("config/tenants",function(o,r){if(o)return void(i&&i(o));if(!r)return void(i&&i());var s=r.getChildren();if(!s||0===s.length)return void(i&&i());var c=[];for(var _e4=0;_e4<s.length;_e4++){var _n3=s[_e4];_n3&&_n3.license&&_n3.license.licenseTxt&&c.push(_n3.license.licenseTxt);}if(0===c.length)return void(i&&i());var l=b(c.join(":"));C(l,function(o,r){if(o)i&&i(o);else if(r){try{var _o4=E(r);if(_o4){for(var _e5 in n)n.hasOwnProperty(_e5)&&(_o4[_e5]||(_o4[_e5]=n[_e5]));n=_o4;}e&&n&&(m.aio.infomanager.IM._logger.log("trace","save pref"),e.save(t,b(JSON.stringify(n))));}catch(o){m.aio.infomanager.IM._logger.log("trace","decode info error: "+o.stack);}i&&i();}else i&&i();});});},P=function P(e){if(!e||!e.valid)return[];var t=S(e),o=U(e),i=y(e);var r=!1;if(n&&n[i]&&n[i].sus_info){var _e6=n[i].sus_info;_e6.hm&&_e6.hm.lite&&(r=!0);}if(r){var _e7=t.indexOf(1);_e7>=0&&t.splice(_e7,1);}else _(t,o);var s=[];if(t.includes(d)){var _e8=[42,43,h];for(var _n4=0;_n4<f.length;_n4++){var _t5=f[_n4];_t5&&!_e8.includes(_n4)&&s.push(_t5);}}else if(t.includes(h))s=f.filter(function(e){return e&&!g.includes(e);}),t.forEach(function(e){if([42,43].includes(e))return;var n=f[e];n&&!s.includes(n)&&s.push(n);});else{for(var _e9=0;_e9<t.length;_e9++){var _n5=t[_e9];42==_n5?t.includes(0)||s.push(f[0]):43==_n5?t.includes(1)||s.push(f[1]):s.push(f[t[_e9]]);}for(var _e10=0;_e10<o.length;_e10++){var _n6=o[_e10].split("@");2===_n6.length&&f.includes(_n6[0])&&parseInt(_n6[1],10)<=10&&s.push(_n6[0]+"_lite");}}s=O(s,a);var c=[];for(var _e11=0;_e11<s.length;_e11++)s[_e11]&&c.push(s[_e11]);return c.includes("hm_ccu3")&&!c.includes("hm")&&c.push("hm"),c;},S=function S(e){var t=y(e);var o=[],i=[];if(n)for(var _e12 in n){if(!n.hasOwnProperty(_e12))continue;if(_e12!=t)continue;var _r2=n[_e12].codes;if(_r2)for(var _e13 in _r2){if(!_r2.hasOwnProperty(_e13))continue;if(!_r2[_e13]||!_r2[_e13].op)continue;var _n7=_r2[_e13],_t6=_n7.op;_t6.features&&_t6.features.length>0&&(_n7.blocked?o=o.concat(_t6.features):i=i.concat(_t6.features));}}o=w(o),i=w(i);var r=function(e){if(!e||!e.valid)return[];var n=[],t=e.features;if(0==e.version)for(var _e14=0;_e14<t.length;_e14++){var _o5=t.readUInt8(t.length-1-_e14);for(var _t7=0;_t7<8;_t7++)_o5>>_t7&1&&n.push(8*_e14+_t7);}else if(1==e.version){var _e15=t.readUInt8(7);1&_e15&&n.push(0),_e15>>1&1&&n.push(1);var _o6=t.readUInt8(3);_o6>>2&1&&n.push(34),_o6>>3&1&&n.push(35),_o6>>6&1&&n.push(38),_o6>>7&1&&n.push(39);var _i2=t.readUInt8(2);1&_i2&&n.push(40),_i2>>2&1&&n.push(42),_i2>>3&1&&n.push(43),t.readUInt8(0)>>7&1&&n.push(d);}else 2==e.version&&t.readUInt8(0)>>7&1&&n.push(d);return n;}(e);return r=function(e,n){var t=[];for(var _o7=0;_o7<e.length;_o7++)n.includes(e[_o7])||t.push(e[_o7]);return t;}(r,o),r=O(r,i),r;},U=function U(e){var t=y(e);var o=[];if(n)for(var _e16 in n){if(!n.hasOwnProperty(_e16))continue;if(_e16!=t)continue;var _i3=n[_e16].codes;if(_i3)for(var _e17 in _i3)if(_i3.hasOwnProperty(_e17)&&_i3[_e17]&&_i3[_e17].op){var _n8=_i3[_e17],_t8=_n8.op;_t8.features_lite&&_t8.features_lite.length>0&&!_n8.blocked&&(o=o.concat(_t8.features_lite));}}var i=[];return o.forEach(function(e){i.includes(e)||i.push(e);}),i;},D=function D(){this.preference=null,this._configmanager=null,this._logger=require("x.logger.js").getLogger("m.aio.infomanager.Manager");};return D.prototype.init=function(a,u,f,d,m){var _this=this;if(f&&(e=f),this._configmanager=u,a&&a.Preference){this.preference=a.Preference;var _e18=a.Preference.read(t);if(_e18)try{n=k(_e18);}catch(e){console.error("[m.aio.infomanager] Decode INFO",e);}else console.warn("[m.aio.infomanager] .pref file not available yet for INFO.");var _r3=a.Preference.read(i);if(_r3)try{o=k(_r3);}catch(e){console.error("[m.aio.infomanager] Decode BLOCKED",e);}else console.warn("[m.aio.infomanager] .pref file not available yet for BLOCKED.");if(!_e18&&!m)return console.debug("[m.aio.infomanager] Trying to request .pref data early."),this.retrieveInfo(),void setTimeout(function(){_this.init(a,u,f,d,!0);},2e3);}switch(process.env.CLOUD){case"local":r=process.env.CLOUD_HOST?process.env.CLOUD_HOST:"localhost",s=8080,c="/webservice"+c,l="/webservice"+l;break;case"dev":r=process.env.CLOUD_HOST?process.env.CLOUD_HOST:"mediola-dev.elasticbeanstalk.com",s=80;break;default:r=process.env.CLOUD_HOST?process.env.CLOUD_HOST:"webservice.mediola.com",s=443;}d&&d();},D.prototype.retrieveInfo=function(e){var _this2=this;var n=require("m.aio.configmanager.js"),t=9e5;var o=2;x(this.preference,n,function(){setInterval(function(){x(_this2.preference,n);},t),o--,0===o&&(e&&e(),e=null);}),I(this.preference,n,function(){setInterval(function(){I(_this2.preference,n);},t),o--,0===o&&(e&&e(),e=null);});},D.prototype.permitSkin=function(e,t){if(!e||!t)return!1;if(S(t).includes(d))return!0;if(u.includes(e))return!0;var o=y(t);return!!(n&&n[o]&&n[o].skins)&&n[o].skins.includes(e);},D.prototype.permitFeature=function(t,o,i,r,s,c){if(!i||!o)return!1;var l=null,a=null;if(-1==e?(l=S(i),a=U(i),_(l,a)):(l=function(t){var o=m.aio.infomanager.IM.hasPartnerUltimate(),i=y(t);var r=[];if(n&&n[i]&&n[i].sus_info){var _t9=n[i].sus_info;if(_t9.ultimate)return[d];for(var _n9 in _t9){if(!_t9.hasOwnProperty(_n9))continue;var _i4=_t9[_n9];if(!_i4.lite&&_i4.deadline>=e||-1==_i4.deadline||o){var _e19=f.indexOf(_n9);r.push(_e19);}}}else{var _n10=S(t);(_n10.includes(d)||o||e<=1504223999e3)&&(r=_n10);}return r;}(i),a=function(t){var o=m.aio.infomanager.IM.hasPartnerUltimate(),i=y(t);var r=[];if(n&&n[i]&&n[i].sus_info){var _t10=n[i].sus_info;for(var _n11 in _t10){if(!_t10.hasOwnProperty(_n11))continue;var _i5=_t10[_n11];(_i5.lite&&_i5.deadline>=e||-1==_i5.deadline||o)&&r.push(_n11+"@"+_i5.devCount);}}else{var _n12=U(t);(e<=1504223999e3||o)&&(r=_n12);}return r;}(i)),l.includes(d))return!0;if(l.includes(h)&&!p.includes(o.sys))return!0;var u=function u(e){var n={"7links":9,abus:0,axis:85,digitus:20,dlink:10,doorbird:70,edimax:13,foscam:12,generic:76,hama:11,instar:4,konine:7,mobotix:75,netatmo:77,nueva:35,telefunken:6};return"number"!=typeof n[e]?-1:n[e];},g=function g(e,n){if(!a||!e)return 0;for(var _t11=0;_t11<n.length;_t11++){var _o8=n[_t11];if(_o8&&_o8.startsWith(e))return _o8=_o8.replace(e+"@",""),parseInt(_o8,10);}return 0;},v=function v(e,n,t){var o=-1;if(!Array.isArray(t))return o;for(var _i6=0;_i6<t.length;_i6++){var _r4=t[_i6];if(_r4&&_r4.info&&_r4.info.sys==e&&(o++,_r4.index===n))break;}return o;};if(["cloudservice","mcontrol","neoserver","virtualdevice","webpage","xs1"].includes(o.sys))return!0;var b=-1;var k={netatmo:37,lightify:36,max:34,homepilot1:33,homepilot2:33,homepilot2v5:33,orvibo_socket:82,execengine:8,siegenia:25,hue:2,easyled:22,milight:41,milightv6:41,wifiled2:21,dmx4all:21,artnet:21,itach:18,irtrans:19,redeye:17,harmony:3,ip:5,edimax:13,ipsync:14,wemo:15,sonos:16,alpha2:23,tado:64,denon:65,heos:[65,69],pioneer:66,yamaha:67,onkyo:68,marantz:69,homewizard:71,neasmart:72,fritz:73,qivicon:74,rwe:27,cloudy:78,samsung_smarthome:79,dlink:81,raumfeld:83,bose:84,nuki:87,warema:88,feller:89,tahoma:92,fibaro:93,digitalstrom:95,mystrom:96,hautau:97,ioBroker:101,dcgw:103,cloud_service:104,gealan:105,nanoleaf:106,shelly:107,openhab:109,homekit:111,gira:112,junghome:113,somfylocal:114,eltako_minisafe2:115,winkhaus:118,matterbridge:119}[o.sys];if("number"==typeof k)b=k;else{if(Array.isArray(k)){for(var _e20=0;_e20<k.length;_e20++){var _n13=k[_e20];if(l.includes(_n13))return!0;}return!1;}switch(o.sys){case"hcgw":if(b=40,null!==o.ip&&void 0!==o.ip){var _e21={brennenstuhl:39,intertechno:38};void 0!==_e21[o.vendor]&&(b=_e21[o.vendor]);}else if(l.includes(38)||l.includes(39))return!0;break;case"orvibo_ir":b="orvibo"===o.vendor?82:35;break;case"aio":if(o.gateway_vendor||null!==o.ip&&void 0!==o.ip){if("KNX"===o.type)return l.includes(30);var _e22={siegenia:25,internorm:24,nueva:35,brelag:98,wir:100,kopp:102,selve:108,eltako_minisafe2:115};if(void 0!==_e22[o.gateway_vendor])b=_e22[o.gateway_vendor];else{if("EA"===o.version){if(l.includes(24))return!0;}else if("E2"===o.version){if(l.includes(102))return!0;}else if("E7"===o.version&&l.includes(108))return!0;if("000C"===String(o.vid).toUpperCase()&&l.includes(115))return!0;var _e23=[30,42,90,91,94];for(var _i7=0,_e24=_e23;_i7<_e24.length;_i7++){var _n14=_e24[_i7];if(l.includes(_n14))return!0;}var _n15=g("aio",a);if(_n15)return v("aio",r,s)<_n15;b=0;}}else{var _e25={CM:108,IV:108,SIAU:25,QA:80,ZWAVE2:91,KNX:30,ZIGBEE:94,BG:98};if(void 0!==_e25[o.type])b=_e25[o.type];else if("ENOCEAN"===o.type){if(c&&"aio"===c.sys&&["C1","C2","CA"].includes(c.version))return!0;b=90;}else{if("CODE"===o.type&&l.includes(115))return!0;var _e26=[24,25,35,42,98,100,102,108];for(var _i8=0,_e27=_e26;_i8<_e27.length;_i8++){var _n16=_e27[_i8];if(l.includes(_n16))return!0;}if(g("aio",a))return!0;b=0;}}break;case"hm":if(l.includes(43)||l.includes(99))return!0;var _e28=g("hm",a);if(_e28)return v("hm",r,s)<_e28;b=1;break;case"cam":switch(o.type){case"jpeg":return!0;case"system":switch(o.manufacturer){case"7links":case"hama":if(l.includes(76))return!0;}if(b=u(o.manufacturer),-1===b)return!1;break;case"custom":b=5;break;case null:case void 0:return!0;}}}return!(b<0&&(b=u(o.sys),-1===b))&&l.includes(b);},D.prototype.getFeatureModules=function(e){return P(e);},D.prototype.getFeatureModulesSUS=function(t){return-1==e?null:function(e){var t=m.aio.infomanager.IM.hasPartnerUltimate(),o=y(e);var i={};if(n&&n[o]&&n[o].sus_info){var _e29=n[o].sus_info,_r5=!!_e29.ultimate;for(var _n17 in _e29){if(!_e29.hasOwnProperty(_n17))continue;var _o9=_e29[_n17];_o9.lite?(i[_n17+"_lite"]=_o9.deadline,t&&(i[_n17+"_lite"]=-1)):(i[_n17]=_r5?-1:_o9.deadline,v.includes(_n17)&&(i[_n17]=-1),t&&(i[_n17]=-1));}a.forEach(function(e){i[e]=-1;});}else{var _n18=1504216799e3;S(e).includes(d)&&(_n18=-1),P(e).forEach(function(e){a.includes(e)?i[e]=-1:(i[e]=_n18,t&&(i[e]=-1));});}return i.hm_ccu3&&(i.hm||(i.hm=i.hm_ccu3),i.hm&&i.hm<i.hm_ccu3&&(i.hm=i.hm_ccu3)),i;}(t);},D.prototype.getSUSFlatrate=function(e){return function(e){var t=y(e);return n&&n[t]&&n[t].sus_flatrate?n[t].sus_flatrate:null;}(e);},D.prototype.getDeviceCount=function(e,n){if(!n||!e)return-1;var t=S(n),o=U(n);if(_(t,o),t.includes(d)||t.includes(h))return-1;var i=null;switch(e.sys){case"aio":if(["IN","IW","SIAU"].includes(e.type))return-1;var _n19=[0,24,25,30,35,90,91,94,98,100,102,108,115];for(var _i9=0,_n20=_n19;_i9<_n20.length;_i9++){var _e30=_n20[_i9];if(t.includes(_e30))return-1;}if(t.includes(42))return 10;i=f[0];break;case"hm":if(t.includes(1)||t.includes(99))return-1;if(t.includes(43))return 10;i=f[1];}if(!i)return-1;var r=0;for(var _e31=0;_e31<o.length;_e31++){var _n21=o[_e31].split("@");if(2===_n21.length&&_n21[0]===i){var _e32=parseInt(_n21[1],10);_e32>r&&(r=_e32);}}return r;},D.prototype.getDeviceCount2=function(e,n,t){if(!e||!n)return void(t&&t(new Error("argument is null")));var o=require("m.aio.configmanager.js").LicenseManager.resolve(n);if(!o)return void(t&&t(new Error("resolve license fail")));var i=this.getDeviceCount(e,o);t&&t(null,i);},D.prototype.updateLicense=function(e,o){var _this3=this;if(!e)return void(o&&o(new Error("license is empty")));var i=b(e);C(i,function(e,i){if(e)o&&o(e);else if(i){try{var _e33=E(i);if(_e33){for(var _t12 in n)n.hasOwnProperty(_t12)&&(_e33[_t12]||(_e33[_t12]=n[_t12]));n=_e33;}_this3.preference&&n&&_this3.preference.save(t,b(JSON.stringify(n)));}catch(e){console.error(e);}o&&o();}else o&&o();});},D.prototype.updateCodeOld=function(e,o,i,r){if(!e||!o||!i)return void(r&&r(new Error("argument is null")));var s=require("m.aio.configmanager.js").LicenseManager.resolve(o);if(!s)return void(r&&r(new Error("resolve license fail")));var c=y(s);if(n||(n={}),n[c]||(n[c]={blocked:!1,codes:{}}),n[c].codes||(n[c].codes={}),n[c].codes[e]={op:k(i),blocked:!1},n[c].codes[e].op&&n[c].codes[e].op.skins&&n[c].codes[e].op.skins.length>0){n[c].skins||(n[c].skins=[]);var _t13=n[c].codes[e].op.skins;for(var _e34=0;_e34<_t13.length;_e34++){var _o10=_t13[_e34];_o10&&!n[c].skins.includes(_o10)&&n[c].skins.push(_o10);}}this.preference&&this.preference.save(t,b(JSON.stringify(n))),r&&r();},D.prototype.updateCode=function(e,o,i,r){var _this4=this;if(!o)return void(r&&r(new Error("argument is null")));var s=b(o);C(s,function(e,o){if(e)r&&r(e);else if(o){try{var _e35=E(o);if(_e35){for(var _t14 in n)n.hasOwnProperty(_t14)&&(_e35[_t14]||(_e35[_t14]=n[_t14]));n=_e35;}_this4.preference&&_this4.preference.save(t,b(JSON.stringify(n)));}catch(e){console.error(e);}r&&r();}else r&&r();});},D.prototype.updateDownloadSkin=function(e,o,i){if(!e||!o)return void(i&&i(new Error("argument is null")));var r=y(e);n||(n={}),n[r]||(n[r]={blocked:!1,codes:{},skins:[]}),n[r].skins||(n[r].skins=[]),n[r].skins.includes(o)||n[r].skins.push(o),this.preference&&this.preference.save(t,b(JSON.stringify(n))),i&&i();},D.prototype.isLicenseBlocked=function(e){if(!o)return!1;for(var _n22=0;_n22<o.length;_n22++)if(o[_n22].version==e.version&&o[_n22].id==e.id&&o[_n22].type==("test"===e.type?1:0))return!0;return!1;},D.prototype.hasPartnerUltimate=function(){var e=this._configmanager.getAllLicenses();if(!e||0===e.length)return!1;for(var _n23=0;_n23<e.length;_n23++){var _t15=e[_n23];if(_t15&&_t15.isPartnerUltimateLicense())return!0;}return!1;},D;}(),m.aio.infomanager.IM=new m.aio.infomanager.Manager(),"undefined"!=typeof module&&null!==module&&(module.exports=m.aio.infomanager.IM);