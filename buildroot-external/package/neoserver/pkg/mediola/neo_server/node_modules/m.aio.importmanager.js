var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,a,b){c instanceof String&&(c=String(c));for(var e=c.length,d=0;d<e;d++){var f=c[d];if(a.call(b,f,d,c))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,a,b){c!=Array.prototype&&c!=Object.prototype&&(c[a]=b.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,a,b,e){if(a){b=$jscomp.global;c=c.split(".");for(e=0;e<c.length-1;e++){var d=c[e];d in b||(b[d]={});b=b[d]}c=c[c.length-1];e=b[c];a=a(e);a!=e&&null!=a&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");var m=m||{};m.aio=m.aio||{};m.aio.importmanager=m.aio.importmanager||{};
m.aio.importmanager.Manager=function(){var c=function(){};c.prototype.importSteckerPRO=function(a,b,e,d){var f=function(a,d){var b={rooms:[],devices:[],gateways:[]};try{var e,f,c=$($.parseXML(d)),k=c.find("gateway");if(k&&0<k.length)for(e=0;e<k.length;e++){var r=k[e];if(r){var g=$(r).find("transmitter");if(g&&0<g.length&&g[0]){var h=$(g[0]),p=h.attr("ip"),v=h.attr("mode");p&&v&&(v=parseInt(v),b.gateways.push({index:b.gateways.length+1,name:("hc"==a?"HC":a)+" Gateway",info:{sys:"hcgw",ip:p,port:49880,
vendor:a,mode:1==v?1:0}}))}}}0==b.gateways.length&&b.gateways.push({index:b.gateways.length+1,name:("hc"==a?"HC":a)+" Gateway",info:{sys:"hcgw",ip:"0.0.0.0",port:49880,vendor:a,mode:1}});var w=c.find("location");if(w&&0<w.length)for(e=0;e<w.length;e++){var B=w[e];if(B){var t=$(B);if(f=t.attr("id")){var x={index:b.rooms.length+1,name:f};b.rooms.push(x);var u=t.find("device");if(u&&0<u.length)for(a=0;a<u.length;a++){var C=u[a];if(C){var y=$(C);f=y.attr("id");var z=y.attr("type"),A=y.attr("address"),
n=y.attr("data");if(f&&z&&A&&n){switch(z){case "BS":var q="brennenstuhl";var l="RC 3600";"heater"==n&&(l="FHT 433");break;case "ELRO":q="brennenstuhl";l="RCS 1000N";break;case "DY":q="rohrmotor24";l="RMF Motor";break;case "DY2":q="rohrmotor24";l="RMF-RS1 (AP/UP)";break;case "IT":q="intertechno",9<=A.length?(l="IT-1500 ","shutter"==n?l="ITL-1000":"dimmer"==n&&(l="ITLR-300")):(l="CMR-300","shutter"==n&&(l="CMR-500"))}b.devices.push({index:b.devices.length+1,name:f,room:x.index,info:{sys:"hcgw",gateway:1,
data:n,type:"IT"==z&&9<=A.length?"IT2":z,manufacture:q,model:l,address:A}})}}}}}}}catch(F){console.error(F)}return b},c=function(a,b){var e={groups:[]};try{var d,f=$($.parseXML(a)).find("location");if(f&&0<f.length)for(d=0;d<f.length;d++){var c=f[d];if(c){var r=$(c),g=r.attr("id"),k;if(k=g)a:{for(a=0;a<b.length;a++)if(b[a]===g){k=!0;break a}k=!1}if(k){var h={classid:"group",index:e.groups.length+1,name:g,macros:[]};e.groups.push(h);var p=r.find("macro");if(p&&0<p.length)for(a=0;a<p.length;a++){var v=
p[a];if(v){var w=$(v),B=w.attr("id");if(B){var t={classid:"macro",index:h.macros.length+1,name:B,commands:[]};h.macros.push(t);var x=w.find("command");if(x&&0<x.length)for(var u=0;u<x.length;u++){var C=x[u];if(C){var y=$(C),z=y.attr("action"),A=y.attr("sleep");if(z){var n=z.split(".");if(3==n.length){var q={classid:"command",index:t.commands.length+1,action:{type:"command",device:{name:n[1],room:n[0]},value:n[2]}};t.commands.push(q)}}else A&&(q={classid:"sleep",index:t.commands.length+1,time:parseInt(A)},
t.commands.push(q))}}}}}}}}}catch(l){console.error(l)}return e},g=require("m.aio.configmanager.js"),r=g.LicenseManager;g.trace("/config/tenants/"+a,function(g,h){if(g)d&&d(g);else if(h&&h.license){if(r.permitFeature("read",{sys:"hcgw",ip:"127.0.0.1",vendor:"brennenstuhl"},h.license))g="brennenstuhl";else if(r.permitFeature("read",{sys:"hcgw",ip:"127.0.0.1",vendor:"intertechno"},h.license))g="intertechno";else if(r.permitFeature("read",{sys:"hcgw",ip:"127.0.0.1",vendor:"hc"},h.license))g="hc";else{d&&
d(Error("license do not have hcgw module"));return}g=f(g,b);var k=[];g&&g.rooms&&g.rooms.forEach(function(a){a&&a.name&&k.push(a.name)});var p=c(e,k);h=require("m.aio.devicemanager.js");var E=require("m.aio.macromanager.js");if(h=h.getIntHandler(a)){var D=E._getHandler(a);D?(h.data=g,h._save(function(a){a?d&&d(a):(D.macros=E.Macros.parse(p),D._saveMacros(function(a){d&&d(a)}))})):d&&d(Error("no such tenant for macros"))}else d&&d(Error("no such tenant"))}else d&&d("invalid tenant")})};c.prototype.getConfigList_IQP=
function(a,b,e,d){a+="/iqconfig/getconfigs";var f=require("url").parse(a);a=f.protocol;"http:"==a&&(a="http");"https:"==a&&(a="https");a||(a="https");var c=f.port;c||(c=443);b={host:f.hostname,port:c,path:f.path+"?app=iqontrolpro",auth:b+":"+e};b=require(a).request(b,function(a){a.setEncoding("utf8");var b="";a.on("data",function(a){b+=a});a.on("end",function(){if(200!=a.statusCode)d&&(d(Error("http reponse code:"+a.statusCode)),d=null);else try{var e=[];b&&(e=JSON.parse(b));d&&(d(null,e),d=null)}catch(p){d&&
(d(Error("invalid json reponse")),d=null)}})});b.on("timeout",function(){d&&(d(Error("http timeout")),d=null)});b.on("error",function(a){d&&(d(a),d=null)});b.end()};c.prototype.downloadConfig_IQP=function(a,b,e,d,f){a+="/iqconfig/getdevices";var c=require("url").parse(a);a=c.protocol;"http:"==a&&(a="http");"https:"==a&&(a="https");a||(a="https");var g=c.port;g||(g=443);b={host:c.hostname,port:g,path:c.path+"?app=iqontrolpro&name="+encodeURIComponent(d),auth:b+":"+e};b=require(a).request(b,function(a){a.setEncoding("utf8");
var b="";a.on("data",function(a){b+=a});a.on("end",function(){200!=a.statusCode?f&&(f(Error("http reponse code:"+a.statusCode)),f=null):f&&(f(null,b),f=null)})});b.on("timeout",function(){f&&(f(Error("http timeout")),f=null)});b.on("error",function(a){f&&(f(a),f=null)});b.end()};c.prototype.decryptConfig_IQP=function(a,b,e){a=require("x.crypt.js").AES.decodeString(a,b);if(0<a.length&&"string"==typeof a){b=null;try{b=JSON.parse(a),e&&e(null,b)}catch(d){e&&e(Error("invalid config json"))}}else e&&e(Error("decryption failed"))};
c.prototype.importConfig_IQP=function(a,b,e){require("m.aio.configmanager.js").trace("/config/tenants/"+a,function(d,c){if(d)e&&e(d);else if(c&&c.license){var f=require("m.aio.devicemanager.js");(d=f.getIntHandler(a))?(d.data=b,d._save(function(a){a?e&&e(a):f.reloadTenant(c,function(a){e&&e(a)})})):e&&e(Error("no such tenant"))}else e&&e("invalid tenant")})};c.prototype.downloadMacros_IQP=function(a,b,e,d,c){a+="/iqconfig/getmacros";var f=require("url").parse(a);a=f.protocol;"http:"==a&&(a="http");
"https:"==a&&(a="https");a||(a="https");var g=f.port;g||(g=443);b={host:f.hostname,port:g,path:f.path+"?app=iqontrolpro&name="+encodeURIComponent(d),auth:b+":"+e};b=require(a).request(b,function(a){a.setEncoding("utf8");var b="";a.on("data",function(a){b+=a});a.on("end",function(){200!=a.statusCode?c&&(c(Error("http reponse code:"+a.statusCode)),c=null):c&&(c(null,b),c=null)})});b.on("timeout",function(){c&&(c(Error("http timeout")),c=null)});b.on("error",function(a){c&&(c(a),c=null)});b.end()};c.prototype.decryptMacros_IQP=
function(a,b,c){a=require("x.crypt.js").AES.decodeString(a,b);if(0<a.length&&"string"==typeof a){b=null;try{b=JSON.parse(a),c&&c(null,b)}catch(d){c&&c(Error("invalid macros json"))}}else c&&c(Error("decryption failed"))};c.prototype.importMacros_IQP=function(a,c,e){require("m.aio.configmanager.js").trace("/config/tenants/"+a,function(b,f){if(b)e&&e(b);else if(f&&f.license){b=require("m.aio.macromanager.js");var d=b._getHandler(a);d?(d.macros=b.Macros.parse(c),d._saveMacros(function(a){a?e&&e(a):require("m.aio.devicemanager.js").reloadTenant(f,
function(a){e&&e(a)})})):e&&e(Error("no such tenant"))}else e&&e("invalid tenant")})};return c}();m.aio.importmanager.Handler=m.aio.importmanager.Manager;"undefined"!=typeof module&&null!=module&&(module.exports=new m.aio.importmanager.Handler);
