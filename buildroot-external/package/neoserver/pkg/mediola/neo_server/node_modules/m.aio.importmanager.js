var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,f,c){b instanceof String&&(b=String(b));for(var d=b.length,a=0;a<d;a++){var e=b[a];if(f.call(c,e,a,b))return{i:a,v:e}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,c){b!=Array.prototype&&b!=Object.prototype&&(b[f]=c.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,f,c,d){if(f){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var a=b[d];a in c||(c[a]={});c=c[a]}b=b[b.length-1];d=c[b];f=f(d);f!=d&&null!=f&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(f,c){return $jscomp.findInternal(this,f,c).v}},"es6","es3");var m=m||{};m.aio=m.aio||{};m.aio.importmanager=m.aio.importmanager||{};
m.aio.importmanager.Manager=function(){var b=function(){};b.prototype.importSteckerPRO=function(f,c,b,a){var d=function(a,f){var c={rooms:[],devices:[],gateways:[]};try{var b,d,r=$($.parseXML(f)),e=r.find("gateway");if(e&&0<e.length)for(b=0;b<e.length;b++){var g=e[b];if(g){var k=$(g).find("transmitter");if(k&&0<k.length&&k[0]){var n=$(k[0]),q=n.attr("ip"),v=n.attr("mode");q&&v&&(v=parseInt(v),c.gateways.push({index:c.gateways.length+1,name:("hc"==a?"HC":a)+" Gateway",info:{sys:"hcgw",ip:q,port:49880,
vendor:a,mode:1==v?1:0}}))}}}0==c.gateways.length&&c.gateways.push({index:c.gateways.length+1,name:("hc"==a?"HC":a)+" Gateway",info:{sys:"hcgw",ip:"0.0.0.0",port:49880,vendor:a,mode:1}});var w=r.find("location");if(w&&0<w.length)for(b=0;b<w.length;b++){var B=w[b];if(B){var t=$(B);if(d=t.attr("id")){var x={index:c.rooms.length+1,name:d};c.rooms.push(x);var u=t.find("device");if(u&&0<u.length)for(a=0;a<u.length;a++){var C=u[a];if(C){var y=$(C);d=y.attr("id");var z=y.attr("type"),A=y.attr("address"),
l=y.attr("data");if(d&&z&&A&&l){switch(z){case "BS":var p="brennenstuhl";var h="RC 3600";"heater"==l&&(h="FHT 433");break;case "ELRO":p="brennenstuhl";h="RCS 1000N";break;case "DY":p="rohrmotor24";h="RMF Motor";break;case "DY2":p="rohrmotor24";h="RMF-RS1 (AP/UP)";break;case "IT":p="intertechno",9<=A.length?(h="IT-1500 ","shutter"==l?h="ITL-1000":"dimmer"==l&&(h="ITLR-300")):(h="CMR-300","shutter"==l&&(h="CMR-500"))}c.devices.push({index:c.devices.length+1,name:d,room:x.index,info:{sys:"hcgw",gateway:1,
data:l,type:"IT"==z&&9<=A.length?"IT2":z,manufacture:p,model:h,address:A}})}}}}}}}catch(F){console.error(F)}return c},q=function(a,f){var c={groups:[]};try{var b,d=$($.parseXML(a)).find("location");if(d&&0<d.length)for(b=0;b<d.length;b++){var e=d[b];if(e){var r=$(e),k=r.attr("id"),g;if(g=k)a:{for(a=0;a<f.length;a++)if(f[a]===k){g=!0;break a}g=!1}if(g){var n={classid:"group",index:c.groups.length+1,name:k,macros:[]};c.groups.push(n);var q=r.find("macro");if(q&&0<q.length)for(a=0;a<q.length;a++){var v=
q[a];if(v){var w=$(v),B=w.attr("id");if(B){var t={classid:"macro",index:n.macros.length+1,name:B,commands:[]};n.macros.push(t);var x=w.find("command");if(x&&0<x.length)for(var u=0;u<x.length;u++){var C=x[u];if(C){var y=$(C),z=y.attr("action"),A=y.attr("sleep");if(z){var l=z.split(".");if(3==l.length){var p={classid:"command",index:t.commands.length+1,action:{type:"command",device:{name:l[1],room:l[0]},value:l[2]}};t.commands.push(p)}}else A&&(p={classid:"sleep",index:t.commands.length+1,time:parseInt(A)},
t.commands.push(p))}}}}}}}}}catch(h){console.error(h)}return c},g=require("m.aio.configmanager.js"),k=g.LicenseManager;g.trace("/config/tenants/"+f,function(e,g){if(e)a&&a(e);else if(g&&g.license){if(k.permitFeature("read",{sys:"hcgw",ip:"127.0.0.1",vendor:"brennenstuhl"},g.license))e="brennenstuhl";else if(k.permitFeature("read",{sys:"hcgw",ip:"127.0.0.1",vendor:"intertechno"},g.license))e="intertechno";else if(k.permitFeature("read",{sys:"hcgw",ip:"127.0.0.1",vendor:"hc"},g.license))e="hc";else{a&&
a(Error("license do not have hcgw module"));return}e=d(e,c);var r=[];e&&e.rooms&&e.rooms.forEach(function(a){a&&a.name&&r.push(a.name)});var n=q(b,r);g=require("m.aio.devicemanager.js");var E=require("m.aio.macromanager.js");if(g=g.getIntHandler(f)){var D=E._getHandler(f);D?(g.data=e,g._save(function(c){c?a&&a(c):(D.macros=E.Macros.parse(n),D._saveMacros(function(c){a&&a(c)}))})):a&&a(Error("no such tenant for macros"))}else a&&a(Error("no such tenant"))}else a&&a("invalid tenant")})};b.prototype.getConfigList_IQP=
function(f,c,b,a){f+="/iqconfig/getconfigs";var e=require("url").parse(f);f=e.protocol;"http:"==f&&(f="http");"https:"==f&&(f="https");f||(f="https");var d=e.port;d||(d=443);c={host:e.hostname,port:d,path:e.path+"?app=iqontrolpro",auth:c+":"+b};c=require(f).request(c,function(c){c.setEncoding("utf8");var b="";c.on("data",function(a){b+=a});c.on("end",function(){if(200!=c.statusCode)a&&(a(Error("http reponse code:"+c.statusCode)),a=null);else try{var f=[];b&&(f=JSON.parse(b));a&&(a(null,f),a=null)}catch(n){a&&
(a(Error("invalid json reponse")),a=null)}})});c.on("timeout",function(){a&&(a(Error("http timeout")),a=null)});c.on("error",function(c){a&&(a(c),a=null)});c.end()};b.prototype.downloadConfig_IQP=function(b,c,d,a,e){b+="/iqconfig/getdevices";var f=require("url").parse(b);b=f.protocol;"http:"==b&&(b="http");"https:"==b&&(b="https");b||(b="https");var g=f.port;g||(g=443);c={host:f.hostname,port:g,path:f.path+"?app=iqontrolpro&name="+encodeURIComponent(a),auth:c+":"+d};c=require(b).request(c,function(a){a.setEncoding("utf8");
var b="";a.on("data",function(a){b+=a});a.on("end",function(){200!=a.statusCode?e&&(e(Error("http reponse code:"+a.statusCode)),e=null):e&&(e(null,b),e=null)})});c.on("timeout",function(){e&&(e(Error("http timeout")),e=null)});c.on("error",function(a){e&&(e(a),e=null)});c.end()};b.prototype.decryptConfig_IQP=function(b,c,d){b=require("x.crypt.js").AES.decodeString(b,c);if(0<b.length&&"string"==typeof b){c=null;try{c=JSON.parse(b),d&&d(null,c)}catch(a){d&&d(Error("invalid config json"))}}else d&&d(Error("decrpty failed"))};
b.prototype.importConfig_IQP=function(b,c,d){require("m.aio.configmanager.js").trace("/config/tenants/"+b,function(a,e){if(a)d&&d(a);else if(e&&e.license){var f=require("m.aio.devicemanager.js");(a=f.getIntHandler(b))?(a.data=c,a._save(function(a){a?d&&d(a):f.reloadTenant(e,function(a){d&&d(a)})})):d&&d(Error("no such tenant"))}else d&&d("invalid tenant")})};return b}();m.aio.importmanager.Handler=m.aio.importmanager.Manager;"undefined"!=typeof module&&null!=module&&(module.exports=new m.aio.importmanager.Handler);
