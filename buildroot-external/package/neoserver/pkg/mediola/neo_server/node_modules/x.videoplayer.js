var x=x||{};x.videoplayer=x.videoplayer||{};
x.videoplayer.Player=function(){var c=function(a){this._options=a;this._listeners={}};c.prototype.on=function(a,b){a&&b&&(this._listeners[a]||(this._listeners[a]=[]),-1==this._listeners[a].indexOf(b)&&this._listeners[a].push(b))};c.prototype.off=function(a,b){a&&b&&this._listeners[a]&&(b=this._listeners[a].indexOf(b),-1!=b&&this._listeners[a].splice(b,1))};c.prototype.init=function(a){throw Error("func init not implemented");};c.prototype.playHLS=function(a){};c.prototype.playFLV=function(a){};c.prototype._emitEvent=
function(a,b){if(a){var e=this._listeners[a];if(e&&0<e.length)for(var d=0;d<e.length;d++){var c=e[d];try{c(b)}catch(f){this._logger.log("trace","call "+a+" listener failed, error:"+f.message)}}}};var d=function(a){c.call(this,a);this._logger=require("x.logger.js").getLogger("x.videoplayer.MobilePlayer");this._playerID=null;var b=this;this._nativeListener=function(a){a?a.error?b._emitEvent("error",Error(a.error)):a.close?b._emitEvent("close"):a.start?b._emitEvent("start"):a.end?b._emitEvent("end"):
a.replay?b._emitEvent("replay"):a.init&&(a.init.error?b._emitEvent("init",Error(a.init.error)):(b._playerID=a.init.playerID,b._emitEvent("init"))):b._emitEvent("error",Error("native bridge error"))}};d.prototype=new c;d.prototype.constructor=d;d.prototype.init=function(a){if(a)this.on("init",a);XC.callHost("videoplayer","createPlayer",this._options?this._options:{},this._nativeListener)};d.prototype.playHLS=function(a,b){XC.callHost("videoplayer","playHLS",{playerID:this._playerID,url:a,duration:b})};
d.prototype.playMP4=function(a,b){XC.callHost("videoplayer","playMP4",{playerID:this._playerID,url:a,duration:b})};d.prototype.playRTSP=function(a,b){XC.callHost("videoplayer","playRTSP",{playerID:this._playerID,url:a,transport:b})};d.prototype.playMultiHLS=function(a){XC.callHost("videoplayer","playMultiHLS",{playerID:this._playerID,urls:a})};d.prototype.playFLV=function(a,b){XC.callHost("videoplayer","playFLV",{playerID:this._playerID,url:a,duration:b})};d.prototype.close=function(){XC.callHost("videoplayer",
"closePlayer",{playerID:this._playerID})};c.iOSPlayer=d;c.AndroidPlayer=d;return c}();
x.videoplayer.Handler=function(){var c=function(){};c.prototype.createVideoPlayer=function(d,a){var b=null,c=null;"undefined"!=typeof window&&null!=window&&window.XCHost||(b="node-webkit");"undefined"!=typeof window&&null!=window&&window.XCHost&&window.XCHost.getType&&(b=window.XCHost.getType());c="Android"==b?new x.videoplayer.Player.AndroidPlayer(d):"node-webkit"==b||"undefined"!=typeof process&&null!=process&&"node"==process.title?new x.videoplayer.Player.NWPlayer(d):new x.videoplayer.Player.iOSPlayer(d);
c.init(function(b){a&&a(b,c)})};return c}();"undefined"!=typeof module&&null!=module&&(module.exports=new x.videoplayer.Handler);
