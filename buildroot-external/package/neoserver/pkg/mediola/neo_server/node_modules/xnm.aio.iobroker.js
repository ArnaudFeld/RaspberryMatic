function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},_typeof(o);}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key);}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.");}return(hint==="string"?String:Number)(input);}var xnm=xnm||{};xnm.aio=xnm.aio||{},xnm.aio.iobroker=xnm.aio.iobroker||{},xnm.aio.iobroker.SimpleAPI=/*#__PURE__*/function(){function e(_e,t,a,s,n){_classCallCheck(this,e);"undefined"==typeof require||null==require?this._logger={log:function log(e,t){console&&console.log&&console.log(e,t);}}:(this._logger=require("x.logger.js").getLogger("xnm.aio.iobroker.SimpleAPI"),require("x.logger.js").setLogToConsole(!0,"xnm.aio.iobroker.SimpleAPI")),this.ip=_e,this.port=t,this.port||(this.port=8087),this.username=a,this.password=s,this.https=n,this._statesCache={},this._statesRequestPending=!1;}_createClass(e,[{key:"executeCommand",value:function executeCommand(_e2,t,a){if(_e2&&_e2.id){if(t&&t.value)switch(t.value){case"setValue":if(null==t.ext||null==t.ext)return void(a&&a(new Error("value invalid")));this._set(_e2.id,{value:t.ext},a);break;case"toggleValue":this._toggle(_e2.id,a);break;default:a&&a(new Error("unknown command"));}else a&&a(new Error("command invalid"));}else a&&a(new Error("device invalid"));}},{key:"getStates",value:function getStates(_e3,t){var _this=this;var a=null;if(1===_e3.length)a=_e3[0];else if(_e3.length>1){_e3.sort(function(e,t){return e.length-t.length;});for(var s=_e3[0].split("."),n="",o=0,r=Math.min(s.length,8);o<r;){for(var i=n+s[o],l=!1,u=1;u<_e3.length;u++)if(0!==_e3[u].indexOf(i)){l=!0;break;}if(l)break;n=i+".",o++;}n&&("."===n[n.length-1]&&(n=n.substr(0,n.length-1)),a=n+"*",this._logger.log("trace","ioBroker states pattern: "+a));}var c=Date.now();for(var _e22 in this._statesCache)c-this._statesCache[_e22].time>=2e3&&delete this._statesCache[_e22];var m=this._statesCache["*"];var d=a||"*",p=this._statesCache[d];if("*"!==d&&m&&(!p||m.time>p.time)&&(d="*",p=m),p){this._logger.log("debug","Request for pattern \"".concat(a,"\" (key: \"").concat(d,"\") answered from cache."));var _s=this._buildStatesReturn(p.data,_e3);return void t(null,_s);}if(this._statesRequestPending){var _e5=new Error("Last ioBroker request is still pending. Ignoring new one.");return this._logger.log("debug",_e5.message),void t(_e5,null);}this._statesRequestPending=!0;var f=setTimeout(function(){_this._logger.log("debug","Gave up on pending request after 3 sec."),_this._statesRequestPending=!1;},3e3);this._states(a,function(a,s){clearTimeout(f),_this._statesRequestPending=!1;var n=null;!a&&s&&(_this._statesCache[d]={data:s,time:Date.now()}),a?_this._logger.log("error",a):n=_this._buildStatesReturn(s,_e3),t(a,n);});}},{key:"_buildStatesReturn",value:function _buildStatesReturn(_e6,t){var a=null;if(t&&0!==t.length){a={};for(var s=0;s<t.length;s++){var n=t[s];_e6[n]&&(a[n]=_e6[n].val);}}else a=_e6;return a;}},{key:"executeCommandCreator",value:function executeCommandCreator(_e7,t,a){if(t&&t.value){if(_e7&&_e7.id){var s=this._resolveCommand(_e7,t);s?this.executeCommand(_e7,s,function(e){a&&a(e);}):a&&a(new Error("unknown command"));}else a&&a(new Error("device json invalid"));}else a&&a(new Error("command json invalid"));}},{key:"isReachable",value:function isReachable(){var _this2=this;return new Promise(function(_e8){_this2._doRequest("GET","/get/system.adapter.simple-api.0.uptime",null,null,function(t,a){if(t)return _this2._logger.log("error",t),void _e8(!1);_e8(!0);});});}},{key:"_resolveCommand",value:function _resolveCommand(_e9,t){if(!t)return null;if("setGenValue"==t.value){var a=t.ext;return void 0!==a&&null!=a||(a=""),{value:"setValue",ext:a};}if("toggle"==t.value)return{value:"toggleValue"};if(!_e9.common)return null;if(!t.value)return null;switch(_e9.common.type){case"boolean":switch(t.value){case"on":case"press":case"longPress":case"stop":case"start":case"open":case"unlock":case"play":case"next":case"prev":case"pause":case"forward":case"reverse":case"fastforward":case"fastreverse":return{value:"setValue",ext:!0};case"off":case"lock":return{value:"setValue",ext:!1};}break;case"number":var s=_e9.common.min,n=_e9.common.max;switch(t.value){case"setValue":if(void 0===t.ext||null==t.ext)return null;var o=parseFloat(t.ext);return isNaN(o)?null:(void 0===s||null==s||isNaN(parseFloat(s))||o<parseFloat(s)&&(o=parseFloat(s)),void 0===n||null==n||isNaN(parseFloat(n))||o>parseFloat(n)&&(o=parseFloat(n)),{value:"setValue",ext:o});case"setRGB":return void 0===t.ext||null==t.ext?null:{value:"setValue",ext:parseInt(t.ext,16)};}break;case"string":return void 0===t.ext||null==t.ext?null:{value:"setValue",ext:t.ext};default:return null;}}},{key:"getStatesCreator",value:function getStatesCreator(_e10,t,a){if(t){if(0!=t.length){for(var s=[],n=0;n<t.length;n++){var o=t[n];o&&o.device&&o.device.id&&-1==s.indexOf(o.device.id)&&s.push(o.device.id);}var r=this;this.getStates(s,function(e,s){if(e)a&&a(e);else{for(var n=[],o=0;o<t.length;o++){var i=t[o];if(i&&i.id){var l=null;i.device&&i.device.id&&i.status&&(l=s[i.device.id],l=r._resolveState(i.device,i.status,l)),void 0!==l&&null!=l||(r._logger.log("error","? status (device:".concat(JSON.stringify(i),")")),l="?"),n.push({id:i.id,status:l});}}a&&a(null,n);}});}else a&&a(null,[]);}else a&&a(new Error("deviceList is null"));}},{key:"_resolveState",value:function _resolveState(_e11,t,a){if(void 0===a||null==a)return null;if(!t||!t.value)return a;if("genValue"==t.value)return a;if(!_e11||!_e11.common)return null;switch(_e11.common.type){case"boolean":switch(_e11.common.role){case"state":case"sensor.light":case"sensor.motion":case"sensor.rain":case"switch":case"switch.boost":case"switch.light":case"switch.comfort":case"media.mode.shuffle":case"media.mode.repeat":case"media.mute":return a?"on":"off";case"sensor.window":case"sensor.door":return a?"open":"closed";case"sensor.lock":case"switch.lock":case"switch.lock.door":case"switch.lock.window":return a?"unlock":"lock";case"media.state":return a?"play":"stop";default:return a;}case"number":switch(_e11.common.role){case"value.window":return _e11.common.states?_e11.common.states[a]:{0:"closed",1:"titled",2:"open"}[a];case"value.time":return parseInt(a);case"media.state":return _e11.common.states?_e11.common.states[a]:{0:"play",1:"stop",2:"pause"}[a];default:return _e11.common.states?_e11.common.states[a]:parseFloat(a);}default:return a;}}},{key:"getStateObjectTree",value:function getStateObjectTree(_e12){var t=[],a=this;this._objects("instance",null,function(s,n){if(s)_e12&&_e12(s);else{var o=0;for(var r in n){o++;var i={id:r,name:r,type:n[r].type,children:[]};a._insertTree(t,i);}a._logger.log("debug","Found "+o+" instances."),a._objects("device",null,function(s,n){if(s)_e12&&_e12(s);else{var o=0;for(var r in n){o++;var i={id:r,name:r,type:n[r].type,children:[]};a._insertTree(t,i);}a._logger.log("debug","Found "+o+" devices."),a._objects("channel",null,function(s,n){if(s)_e12&&_e12(s);else{var o=0;for(var r in n){o++;var i={id:r,name:r,type:n[r].type,children:[]};a._insertTree(t,i);}a._logger.log("debug","Found "+o+" channels."),a._objects("state",null,function(s,n){if(s)_e12&&_e12(s);else{var o=0;for(var r in n){o++;var i=n[r],l={sys:"iobroker",id:r,name:r,type:i.type,common:i.common};a._insertTree(t,l);}a._logger.log("debug","Found "+o+" states."),a._logger.log("debug","Final tree has length of: "+t.length),_e12&&_e12(null,t);}});}});}});}});}},{key:"_insertTree",value:function _insertTree(_e13,t){if(_e13&&t){var a=t.name;"system.adapter."==a.substr(0,15)&&(a=a.substr(15),t.name=a);for(var s=0;s<_e13.length;s++){var n=_e13[s];if(n.name&&a.substr(0,n.name.length+1)==n.name+".")return t.name=a.substr(n.name.length+1),void this._insertTree(n.children,t);}_e13.push(t);}}},{key:"getAllAdapters",value:function getAllAdapters(_e14){this._objects("adapter",null,function(e,t){console.log(e,t);});}},{key:"_objects",value:function _objects(_e15,t,a){var s=null;(_e15||t)&&(s={}),_e15&&(s.type=_e15),t&&(s.pattern=t),this._doRequest("GET","/objects",s,null,function(e,t){a&&a(e,t);});}},{key:"_getBulk",value:function _getBulk(_e16,t){this._doRequest("GET","/getBulk/"+encodeURIComponent(_e16.join(",")),null,null,function(e,a){t&&t(e,a);});}},{key:"_get",value:function _get(_e17,t){var a;a=Array.isArray(_e17)?encodeURIComponent(_e17.join(",")):encodeURIComponent(_e17),this._doRequest("GET","/get/"+a,null,null,function(e,a){t&&t(e,a);});}},{key:"_set",value:function _set(_e18,t,a){this._doRequest("GET","/set/"+encodeURIComponent(_e18),t,null,function(e,t){a&&a(e,t);});}},{key:"_toggle",value:function _toggle(_e19,t){this._doRequest("GET","/toggle/"+encodeURIComponent(_e19),null,null,function(e,a){t&&t(e,a);});}},{key:"_states",value:function _states(_e20,t){var a=null;_e20&&(a={pattern:_e20}),this._doRequest("GET","/states",a,null,function(e,a){t&&t(e,a);});}},{key:"_doRequest",value:function _doRequest(_e21,t,a,s,n){var o=t;o||(o="/");var r={};a&&(r=JSON.parse(JSON.stringify(a))),this._logger.log("trace","do request: "+_e21+" "+t+"? "+JSON.stringify(r)),this.username&&(r.user=this.username,r.pass=this.password);var i="";for(var l in r)r.hasOwnProperty(l)&&(i&&(i+="&"),i+=l+"="+encodeURIComponent(r[l]));i&&(o+="?"+i);var u={host:this.ip,port:this.port,path:o,method:_e21,headers:{Connection:"close","Content-Type":"application/json; charset=utf-8"}};s&&(u.headers["Content-Length"]=s.length);var c=require("http");this.https&&(c=require("https"),"undefined"!=typeof process&&null!=process&&process.env&&(process.env.NODE_TLS_REJECT_UNAUTHORIZED="0"),u.rejectUnauthorized=!1);var m=this,d=n,p=c.request(u,function(e){e.setEncoding("utf-8");var t="";e.on("data",function(e){t+=e;}),e.on("end",function(){var a,s,n=e.statusCode&&e.statusCode>399?"error":"trace";if(m._logger.log(n,"receive code:"+e.statusCode+" headers:"+JSON.stringify(e.headers)+" response:"+t),200==e.statusCode)try{s=t?JSON.parse(t):{};}catch(e){a=e;}else a=new Error("http response code :"+e.statusCode);d&&(d(a,s,e.statusCode),d=null);});});p.on&&p.on("error",function(e){m._logger.log("error","do request error:"+e.message),d&&(d(e),d=null);}),p.setTimeout&&p.setTimeout(1e4,function(){m._logger.log("error","do request timeout"),p.abort(),d&&(d(new Error("timeout")),d=null);}),s&&(this._logger.log("trace","do request send body:"+s),p.write(s)),p.end();}},{key:"toJSON",value:function toJSON(){return{sys:"iobroker",ip:this.ip,port:this.port,username:this.username,password:this.password,https:this.https};}},{key:"equalsTo",value:function equalsTo(t){return!!t&&t instanceof e&&this.ip==t.ip&&this.username==t.username&&this.password==t.password;}}],[{key:"parseJSON",value:function parseJSON(t){return t.ip?new e(t.ip,t.port,t.username,t.password,t.https):null;}}]);return e;}(),xnm.aio.iobroker.DM=function(){var e=function e(_e23,t){this.code=_e23,this.message=t,this.stack=new Error().stack;};return(e.prototype=new Error()).name="ioBrokerDMError",e.prototype.code=0,e.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOWN:4,NOT_FOUND:5,IP_EXISTS:6},{SYS:"ioBroker",getGatewayType:function getGatewayType(){return[{sys:this.SYS,name:"ioBroker"}];},createGateway:function createGateway(t,a,s){var n=e,o=e.ERROR_CODE;t?t.ip?new xnm.aio.iobroker.Handler().isReachable(t).then(function(e){e?s(null,t):s(new n(o.NOT_FOUND,"is unreachable"));})["catch"](function(e){s(new n(o.UNKNOWN,e.message));}):s(new n(o.INVALID,"ip is invalid")):s(new n(o.INVALID,"info is invalid"));},updateGateway:function updateGateway(t,a,s,n){var o=e,r=e.ERROR_CODE;a?a.ip?new xnm.aio.iobroker.Handler().isReachable(a).then(function(e){e?n(null,a):n(new o(r.NOT_FOUND,"is unreachable"));})["catch"](function(e){n(new o(r.UNKNOWN,e.message));}):n(new o(r.INVALID,"ip is invalid")):n(new o(r.INVALID,"update is invalid"));},deleteGateway:function deleteGateway(e,t,a){a();},createDevice:function createDevice(t,a,s){var n=e,o=e.ERROR_CODE;if(t){if(t.id){if(t.type){if(t.common){if(t.gateway){var r,i,l=a.data.gateways;for(r=0;r<l.length;r++)if(l[r].index===t.gateway){i=l[r];break;}i?s&&s(null,t):s(new n(o.NOT_FOUND,"gateway with index "+t.gateway+" not exists"));}else s(new n(o.INVALID,"gateway is invalid"));}else s(new n(o.INVALID,"common is invalid"));}else s(new n(o.INVALID,"type is invalid"));}else s(new n(o.INVALID,"id is invalid"));}else s(new n(o.INVALID,"info is invalid"));},updateDevice:function updateDevice(t,a,s){var n=e,o=e.ERROR_CODE;if(t){if(t.id){if(t.type){if(t.common){if(t.gateway){var r,i,l=a.data.gateways;for(r=0;r<l.length;r++)if(l[r].index===t.gateway){i=l[r];break;}i?s(null,t):s(new n(o.NOT_FOUND,"gateway with index "+t.gateway+" not exists"));}else s(new n(o.INVALID,"gateway is invalid"));}else s(new n(o.INVALID,"common is invalid"));}else s(new n(o.INVALID,"type is invalid"));}else s(new n(o.INVALID,"id is invalid"));}else s(new n(o.INVALID,"info is invalid"));},deleteDevice:function deleteDevice(e,t,a){a();},applyUIFilter:function applyUIFilter(e,t,a){var s=function s(e,t){if("*"==e)return!0;for(var a=!1,s=0;s<e.length;s++)if(e[s]==t){a=!0;break;}return a;},n=function n(e,t){var n=[],o=null,r=xnm.aio.iobroker.DM.getCommandStatusMap(e,a);return r&&(o=function(e,t,a){var n=[];return"command"==a.catagory?e.command&&e.command.forEach(function(e){if(s(a.elems,e.type)){var t=JSON.parse(JSON.stringify(e));n.push(t);}}):"status"==a.catagory&&e.status&&e.status.forEach(function(e){if(s(a.elems,e.type)){var t=JSON.parse(JSON.stringify(e));n.push(t);}}),n;}(r,0,t),n=n.concat(o)),n;};if(!e.sys)return null;var o=JSON.parse(JSON.stringify(e)),r=null;if("command"==t.catagory)r=n(e,t),o.command=r;else{if("status"!=t.catagory)return null;r=n(e,t),o.status=r;}return r&&0!=r.length?o:null;},getCommandStatusMap:function getCommandStatusMap(e,t){if(!e||"state"!=e.type||!e.common)return null;var a={command:[],status:[]},s=e.common.min,n=e.common.max,o=e.common.unit,r=null;if(e.common.write||void 0===e.common.write)switch(a.command.push({type:"string",name:"set generic value",ref:{value:"setGenValue",ext:"%s"}}),e.common.type){case"boolean":switch(e.common.role){case"button":a.command.push({type:"enum",name:"press",ref:{value:"press"}});break;case"button.long":a.command.push({type:"enum",name:"long press",ref:{value:"longPress"}});break;case"button.stop":a.command.push({type:"enum",name:"stop",ref:{value:"stop"}});break;case"button.start":a.command.push({type:"enum",name:"start",ref:{value:"start"}});break;case"button.open.door":case"button.open.window":a.command.push({type:"enum",name:"open",ref:{value:"open"}});break;case"switch.lock":case"switch.lock.door":case"switch.lock.window":a.command.push({type:"enum",name:"unlock",ref:{value:"unlock"}}),a.command.push({type:"enum",name:"lock",ref:{value:"lock"}}),a.command.push({type:"enum",name:"toggle",ref:{value:"toggle"}});break;case"media.state ":a.command.push({type:"enum",name:"play",ref:{value:"play"}}),a.command.push({type:"enum",name:"stop",ref:{value:"stop"}}),a.command.push({type:"enum",name:"toggle",ref:{value:"toggle"}});break;default:a.command.push({type:"enum",name:"on",ref:{value:"on"}}),a.command.push({type:"enum",name:"off",ref:{value:"off"}}),a.command.push({type:"enum",name:"toggle",ref:{value:"toggle"}});}break;case"number":switch(e.common.role){case"level.temperature":void 0!==s&&null!=s||(s=5),void 0!==n&&null!=n||(n=40),(r={type:"float",name:"set value",ref:{value:"setValue",ext:"%f",extMeta:"5.0-40.0"}}).ref.extMeta=s+"-"+n,o&&(r.ref.unit=o),a.command.push(r);break;case"level.color.red":case"level.color.green":case"level.color.blue":case"level.color.white":void 0!==s&&null!=s||(s=0),void 0!==n&&null!=n||(n=255),(r={type:"float",name:"set value",ref:{value:"setValue",ext:"%f",extMeta:"0-255"}}).ref.extMeta=s+"-"+n,o&&(r.ref.unit=o),a.command.push(r);break;case"level.color.rgb":void 0!==s&&null!=s||(s=0),void 0!==n&&null!=n||(n=16777215),(r={type:"float",name:"set value",ref:{value:"setValue",ext:"%f",extMeta:"0-16777215"}}).ref.extMeta=s+"-"+n,o&&(r.ref.unit=o),a.command.push(r),r={type:"rgb",name:"set RGB",ref:{value:"setRGB",ext:"%s"}},a.command.push(r);break;default:void 0!==s&&null!=s||(s=0),void 0!==n&&null!=n||(n=100),(r={type:"float",name:"set value",ref:{value:"setValue",ext:"%f",extMeta:"0-100"}}).ref.extMeta=s+"-"+n,o&&(r.ref.unit=o),a.command.push(r);}break;case"string":a.command.push({type:"string",name:"set value",ref:{value:"setValue",ext:"%s"}});}if(e.common.read||void 0===e.common.read)switch(a.status.push({type:"string",name:"generic value",ref:{value:"genValue"}}),e.common.type){case"boolean":switch(e.common.role){case"state":case"sensor.light":case"sensor.motion":case"sensor.rain":case"switch":case"switch.boost":case"switch.light":case"switch.comfort":case"media.mode.shuffle":case"media.mode.repeat":case"media.mute":a.status.push({type:"enum",name:"state",ref:{value:"state",options:["on","off"]}});break;case"sensor.window":case"sensor.door":a.status.push({type:"enum",name:"state",ref:{value:"state",options:["open","closed"]}});break;case"sensor.lock":case"switch.lock":case"switch.lock.door":case"switch.lock.window":a.status.push({type:"enum",name:"state",ref:{value:"state",options:["unlock","lock"]}});break;case"media.state":a.status.push({type:"enum",name:"state",ref:{value:"state",options:["play","stop"]}});break;default:a.status.push({type:"enum",name:"state",ref:{value:"state",options:["true","false"]}});}break;case"number":switch(e.common.role){case"value.window":for(var i in r={type:"enum",name:"state",ref:{value:"state",options:[]}},e.common.states)e.common.states.hasOwnProperty(i)&&void 0!==(l=e.common.states[i])&&null!=l&&r.ref.options.push(l);0==r.ref.options.length&&(r.ref.options=["closed","tilted","open"]),a.status.push(r);break;case"value.time":a.status.push({type:"int",name:"state",ref:{value:"state"}});break;case"media.state":for(var i in r={type:"enum",name:"state",ref:{value:"state",options:[]}},e.common.states)e.common.states.hasOwnProperty(i)&&void 0!==(l=e.common.states[i])&&null!=l&&r.ref.options.push(l);0==r.ref.options.length&&(r.ref.options=["play","stop","pause"]),a.status.push(r);break;default:if(e.common.states){for(var i in r={type:"enum",name:"state",ref:{value:"state",options:[]}},e.common.states){var l;e.common.states.hasOwnProperty(i)&&void 0!==(l=e.common.states[i])&&null!=l&&r.ref.options.push(l);}a.status.push(r);}else r={type:"float",name:"state",ref:{value:"state"}},(void 0!==s&&null!=s&&void 0===n||null!=n)&&(r.ref.extMeta=s+"-"+n),o&&(r.ref.unit=o),a.status.push(r);}break;case"string":a.status.push({type:"string",name:"state",ref:{value:"state"}});}return a;}};}(),xnm.aio.iobroker.Handler=function(){var e=function e(){};return e.prototype.devicemanager=xnm.aio.iobroker.DM,e.prototype.SimpleAPI=xnm.aio.iobroker.SimpleAPI,e.prototype.registModule=function(e){e.register(this.devicemanager.SYS,"iobroker");},e.prototype.resolveGateway=function(e){return e?this.SimpleAPI.parseJSON(e):null;},e.prototype.getDeviceCommands=function(e,t){var a=this.devicemanager.applyUIFilter(e,{catagory:"command",elems:"*"}),s=a?a.command:[];t&&t(null,s);},e.prototype.getDeviceStatus=function(e,t){var a=this.devicemanager.applyUIFilter(e,{catagory:"status",elems:"*"}),s=a?a.status:[];t&&t(null,s);},e.prototype.doCommand=function(e,t,a,s){var n=this.resolveGateway(e);n?n.executeCommandCreator(t,a,function(e){s&&s(e);}):s&&s(new Error("gateway json format invalid"));},e.prototype.doStatus=function(e,t,a,s,n){var o=this.resolveGateway(t);if(o){var r=[{id:e,device:a,status:s}];o.getStatesCreator(null,r,function(e,t){e?n&&n(e):n&&n(null,t[0]);});}else n&&n(new Error("gateway json format invalid"));},e.prototype.getDeviceList=function(e,t){var a=this.resolveGateway(e);a?a.getStateObjectTree(function(e,a){t&&t(e,a);}):t&&t(new Error("gateway json format invalid"));},e.prototype.isReachable=function(e){return this.resolveGateway(e).isReachable().then(function(e){return e;});},e;}(),"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new xnm.aio.iobroker.Handler());