var xnm=xnm||{};xnm.aio=xnm.aio||{};xnm.aio.gealan=xnm.aio.gealan||{};
xnm.aio.gealan.Fan=function(){var g={_stateTimeout:10,_errorTimeout:5,_buffer:{},getFanStates:function(a){var b=this._buffer[a];b||(this._buffer[a]={},b=this._buffer[a]);if(a=b.fan){b=a.time;var c=Math.round((new Date).getTime()/1E3);if(!(!b||c-b>this._stateTimeout||null==a.states&&c-b>this._errorTimeout))return a.states}else b.fan={}},setFanStates:function(a,b){var c=this._buffer[a];c||(this._buffer[a]={},c=this._buffer[a]);a=c.fan;a||(c.fan={},a=c.fan);c=Math.round((new Date).getTime()/1E3);a.states=
b;a.time=c},getFilterStates:function(a){var b=this._buffer[a];b||(this._buffer[a]={},b=this._buffer[a]);if(a=b.filter){b=a.time;var c=Math.round((new Date).getTime()/1E3);if(!(!b||c-b>this._stateTimeout||null==a.states&&c-b>this._errorTimeout))return a.states}else b.filter={}},setFilterStates:function(a,b){var c=this._buffer[a];c||(this._buffer[a]={},c=this._buffer[a]);a=c.filter;a||(c.filter={},a=c.filter);c=Math.round((new Date).getTime()/1E3);a.states=b;a.time=c}},d=function(a,b,c,d){this._logger=
require("x.logger.js").getLogger("xnm.aio.gealan.Fan");this._ip=a;this._port=b;this._port||(this._port=80);this._username=c;this._password=d;this._timeout=2E3;this._readFilterCallbacks=[];this._readFanCallbacks=[]};d.prototype.executeCommandCreator=function(a,b,c){if(b&&b.value)switch(b.value){case "setLevel":a=parseInt(b.ext);if(isNaN(a)){c&&c(Error("level value invalid"));break}switch(a){case 0:this._setStandBy(c);break;case 1:this._setLevel1(c);break;case 2:this._setLevel2(c);break;case 3:this._setLevel3(c);
break;case 4:this._setLevel4(c);break;case 5:this._setLevel5(c);break;default:c&&c(Error("level value out of range"))}break;case "automatic":this._setAutomatic(c);break;case "manual":this._setManual(c);break;case "nextLevel":this._setNextLevel(c);break;case "previousLevel":this._setPreviousLevel(c);break;case "nightIn":a=parseInt(b.ext);if(isNaN(a)){c&&c(Error("night in value invalid"));break}switch(a){case 1:this._setNightIn1(c);break;case 2:this._setNightIn2(c);break;case 3:this._setNightIn3(c);
break;default:c&&c(Error("night in value out of range"))}break;case "nightOut":a=parseInt(b.ext);if(isNaN(a)){c&&c(Error("night out value invalid"));break}switch(a){case 1:this._setNightOut1(c);break;case 2:this._setNightOut2(c);break;case 3:this._setNightOut3(c);break;default:c&&c(Error("night out value out of range"))}break;case "resetFilter":this._resetFilter(calllback);break;case "resetError":this._resetError(calllback)}else c&&c(Error("command value is empty"))};d.prototype.getStatesCreator=
function(a,b,c){for(var d=this,n=function(a,b,c){var k=[],e,f;switch(a){case "main":d.getMainStates(function(a,d){if(a)c(a);else{for(e=0;e<b.length;e++)if((f=b[e])&&f.id&&f.status)switch(f.status.value){case "tempIn":case "tempOut":case "humIn":k.push({id:f.id,status:d[f.status.value]})}c(null,k)}});break;case "general":d.getGeneralStates(function(a,d){if(a)c(a);else{for(e=0;e<b.length;e++)if((f=b[e])&&f.id&&f.status)switch(f.status.value){case "level":case "mode":case "stateNr":case "stateNrInt":case "error":case "errorNr":case "nightSpeed":case "filterReplace":case "logEntries":case "humidityNr":case "freezeNr":case "usageMode":case "nightModeState":k.push({id:f.id,
status:d[f.status.value]})}c(null,k)}});break;case "ambients":d.getAmbientsStates(function(a,d){if(a)c(a);else{for(e=0;e<b.length;e++)if((f=b[e])&&f.id&&f.status)switch(f.status.value){case "temp1":case "temp2":case "temp3":case "temp4":case "hum1":case "hum2":k.push({id:f.id,status:d[f.status.value]})}c(null,k)}});break;case "filter":d.getFilterStates(function(a,d){if(a)c(a);else{for(e=0;e<b.length;e++)if((f=b[e])&&f.id&&f.status)switch(f.status.value){case "elapsed":case "ramining":k.push({id:f.id,
status:d?d[f.status.value]:"?"})}c(null,k)}});break;case "fan":d.getFanStates(function(a,d){if(a)c(a);else{for(e=0;e<b.length;e++)if((f=b[e])&&f.id&&f.status)switch(f.status.value){case "targetRSIn":case "currentRSIn":case "targetRSOut":case "currentRSOut":case "maxRS":case "minRS":k.push({id:f.id,status:d?d[f.status.value]:"?"})}c(null,k)}})}},e=[],f=0;f<b.length;f++){var l=b[f];if(l&&l.id&&l.status&&l.status.value)switch(l.status.value){case "tempIn":case "tempOut":case "humIn":-1==e.indexOf("main")&&
e.push("main");break;case "level":case "mode":case "stateNr":case "stateNrInt":case "error":case "errorNr":case "nightSpeed":case "filterReplace":case "logEntries":case "humidityNr":case "freezeNr":case "usageMode":case "nightModeState":-1==e.indexOf("general")&&e.push("general");break;case "temp1":case "temp2":case "temp3":case "temp4":case "hum1":case "hum2":-1==e.indexOf("ambients")&&e.push("ambients");break;case "elapsed":case "ramining":-1==e.indexOf("filter")&&e.push("filter");break;case "targetRSIn":case "currentRSIn":case "targetRSOut":case "currentRSOut":case "maxRS":case "minRS":-1==
e.indexOf("fan")&&e.push("fan")}}if(0==e.length)c&&c(null,[]);else{var h=0,m=[],g=function(d,f){h++;!d&&f&&(m=m.concat(f),"undefined"!=typeof a&&null!=a&&"undefined"!=typeof a.reportStates&&null!=a.reportStates&&a.reportStates(null,f));h<e.length?n(e[h],b,g):c&&c(null,m)};n(e[h],b,g)}};d.prototype.getMainStates=function(a){var b=this;this._readMain(function(c,d){c?a&&a(c):(c=b._resolveMainStates(d),a&&a(null,c))})};d.prototype._resolveMainStates=function(a){var b={};b.tempIn=parseInt(a.TempIn)/100;
b.tempOut=parseInt(a.TempOut)/100;b.humIn=parseInt(a.HumidityIn)/100;return b};d.prototype.getGeneralStates=function(a){var b=this;this._readStatus(function(c,d){c?a&&a(c):(c=b._resolveGeneralStates(d),a&&a(null,c))})};d.prototype._resolveGeneralStates=function(a){var b={};b.stateNr=parseInt(a.StateNr);5>=b.stateNr?(b.level=b.stateNr,b.mode="MANUAL"):(b.level="",b.mode=a.State);10==b.stateNr?(b.error=a.Error,b.errorNr=a.ErrorNr):(b.error="",b.errorNr="");b.nightSpeed=7==b.stateNr||8==b.stateNr?parseInt(a.NightSpeed):
"";b.stateNrInt=parseInt(a.StateNrInternal);b.logEntries=parseInt(a.LOGEntries);b.filterReplace="yes"==a.ReplaceFilter;b.humidityNr=parseInt(a.StateOfHumidityNr);b.freezeNr=parseInt(a.StateOfFreezeNr);b.usageMode=parseInt(a.UsageMode);b.nightModeState=parseInt(a.NightModeState);return b};d.prototype.getAmbientsStates=function(a){var b=this;this._readAmbients(function(c,d){c?a&&a(c):(c=b._resolveAmbientsStates(d),a&&a(null,c))})};d.prototype._resolveAmbientsStates=function(a){var b={};b.temp1=parseInt(a.Temp1)/
100;b.temp2=parseInt(a.Temp2)/100;b.temp3=parseInt(a.Temp3)/100;b.temp4=parseInt(a.Temp4)/100;b.hum1=parseInt(a.Humidity1)/100;b.hum2=parseInt(a.Humidity2)/100;return b};d.prototype.getFilterStates=function(a){var b=g.getFilterStates(this._ip);if("undefined"!=typeof b)null!=b&&(b=this._resolveFilterStates(b)),a&&a(null,b);else{var c=this;this.readFilter(function(b,d){g.setFilterStates(c._ip,b?null:d);b=c._resolveFilterStates(d);a&&a(null,b)})}};d.prototype._resolveFilterStates=function(a){var b={};
b.elapsed=parseInt(a.Elapsed);b.ramining=parseInt(a.Remaining);return b};d.prototype.getFanStates=function(a){var b=g.getFanStates(this._ip);if("undefined"!=typeof b)null!=b&&(b=this._resolveFanStates(b)),a&&a(null,b);else{var c=this;this.readFan(function(b,d){g.setFanStates(c._ip,b?null:d);b=c._resolveFanStates(d);a&&a(null,b)})}};d.prototype._resolveFanStates=function(a){var b={};b.targetRSIn=parseInt(a.TargetRotationSpeedIN);b.currentRSIn=parseInt(a.ActualRotationSpeedIN);b.targetRSOut=parseInt(a.TargetRotationSpeedOUT);
b.currentRSOut=parseInt(a.ActualRotationSpeedOUT);b.maxRS=parseInt(a.MaxRotationSpeed);b.minRS=parseInt(a.MinRotationSpeed);return b};d.prototype.readFilter=function(a){var b=this._readFilterCallbacks.length;a&&-1==this._readFilterCallbacks.indexOf(a)&&this._readFilterCallbacks.push(a);if(0==b){var c=this,d=function(a,b){var d=c._readFilterCallbacks;c._readFilterCallbacks=[];for(var e=0;e<d.length;e++)try{d[e](a,b)}catch(h){}};this._cmdReadFilter(function(a){if(a)d(a);else{var b=0,f=function(a,e){a?
d(a):"yes"==e.ready?d(null,e):50<b?d(Error("filter not ready")):(b++,setTimeout(function(){c._readFilter(f)},500))};c._readFilter(f)}})}};d.prototype.readFan=function(a){var b=this._readFanCallbacks.length;a&&-1==this._readFanCallbacks.indexOf(a)&&this._readFanCallbacks.push(a);if(0==b){var c=this,d=function(a,b){var d=c._readFanCallbacks;c._readFanCallbacks=[];for(var e=0;e<d.length;e++)try{d[e](a,b)}catch(h){}};this._cmdReadFan(function(a){if(a)d(a);else{var b=0,f=function(a,e){a?d(a):"yes"==e.ready?
d(null,e):50<b?d(Error("fan not ready")):(b++,setTimeout(function(){c._readFan(f)},500))};c._readFan(f)}})}};d.prototype._setStandBy=function(a){this._doRequest("POST","/CommandSET_STANDBY.cmd",null,function(b){a&&a(b)})};d.prototype._setLevel1=function(a){this._doRequest("POST","/CommandSET_LEVEL1.cmd",null,function(b){a&&a(b)})};d.prototype._setLevel2=function(a){this._doRequest("POST","/CommandSET_LEVEL2.cmd",null,function(b){a&&a(b)})};d.prototype._setLevel3=function(a){this._doRequest("POST",
"/CommandSET_LEVEL3.cmd",null,function(b){a&&a(b)})};d.prototype._setLevel4=function(a){this._doRequest("POST","/CommandSET_LEVEL4.cmd",null,function(b){a&&a(b)})};d.prototype._setLevel5=function(a){this._doRequest("POST","/CommandSET_LEVEL5.cmd",null,function(b){a&&a(b)})};d.prototype._setAutomatic=function(a){this._doRequest("POST","/CommandSET_AUTOMATIC.cmd",null,function(b){a&&a(b)})};d.prototype._setManual=function(a){this._doRequest("POST","/CommandSET_MANUAL.cmd",null,function(b){a&&a(b)})};
d.prototype._setNextLevel=function(a){this._doRequest("POST","/CommandSET_NEXT_LEVEL.cmd",null,function(b){a&&a(b)})};d.prototype._setPreviousLevel=function(a){this._doRequest("POST","/CommandSET_PREV_LEVEL.cmd",null,function(b){a&&a(b)})};d.prototype._setNightIn1=function(a){this._doRequest("POST","/CommandSET_N_IN1.cmd",null,function(b){a&&a(b)})};d.prototype._setNightIn2=function(a){this._doRequest("POST","/CommandSET_N_IN2.cmd",null,function(b){a&&a(b)})};d.prototype._setNightIn3=function(a){this._doRequest("POST",
"/CommandSET_N_IN3.cmd",null,function(b){a&&a(b)})};d.prototype._setNightOut1=function(a){this._doRequest("POST","/CommandSET_N_OUT1.cmd",null,function(b){a&&a(b)})};d.prototype._setNightOut2=function(a){this._doRequest("POST","/CommandSET_N_OUT2.cmd",null,function(b){a&&a(b)})};d.prototype._setNightOut3=function(a){this._doRequest("POST","/CommandSET_N_OUT3.cmd",null,function(b){a&&a(b)})};d.prototype._cmdReadFilter=function(a){this._doRequest("POST","/CommandREAD_FILTER.cmd",null,function(b){a&&
a(b)})};d.prototype._cmdReadParameterLog=function(a,b){this._doRequest("POST","/CommandPARAMETER_READ_LOG"+a+".cmd",null,function(a){b&&b(a)})};d.prototype._cmdReadFan=function(a){this._doRequest("POST","/CommandREAD_FAN.cmd",null,function(b){a&&a(b)})};d.prototype._cmdReadWlanScan=function(a){this._doRequest("POST","/CommandREAD_WLANSCAN.cmd",null,function(b){a&&a(b)})};d.prototype._readMain=function(a){this._doRequestXML("GET","/CmdResultREAD_MAIN.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&
a(null,c.State):a&&a(Error("READ_MAIN response invalid"))})};d.prototype._readStatus=function(a){this._doRequestXML("GET","/CmdResultREAD_STATUS.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&a(Error("READ_STATUS response invalid"))})};d.prototype._readSoftware=function(a){this._doRequestXML("GET","/CmdResultREAD_SOFTWARE.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&a(Error("READ_SOFTWARE response invalid"))})};d.prototype._readAmbients=function(a){this._doRequestXML("GET",
"/CmdResultREAD_AMBIENTS.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&a(Error("READ_AMBIENTS response invalid"))})};d.prototype._readFilter=function(a){this._doRequestXML("GET","/CmdResultREAD_FILTER.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&a(Error("READ_FILTER response invalid"))})};d.prototype._readParameterLog=function(a,b){this._doRequestXML("GET","/CmdResultPARAMETER_READ_LOG"+a+".cmd",null,function(a,d){a?b&&b(a):d&&d.State?b&&b(null,d.State):
b&&b(Error("PARAMETER_READ_LOG response invalid"))})};d.prototype._readFan=function(a){this._doRequestXML("GET","/CmdResultREAD_FAN.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&a(Error("READ_FAN response invalid"))})};d.prototype._readWlanScan=function(a){this._doRequestXML("GET","/CmdResultREAD_WLANSCAN.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&a(Error("READ_WLANSCAN response invalid"))})};d.prototype._readIpMac=function(a){this._doRequestXML("GET",
"/CmdResultREAD_IPMAC.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&a(Error("CmdResultREAD_IPMAC.cmd response invalid"))})};d.prototype._readWifiSettings=function(a){this._doRequestXML("GET","/CmdResultREAD_WIFISETTINGS.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&a(Error("READ_MAIN response invalid"))})};d.prototype._readSignal=function(a){this._doRequestXML("GET","/CmdResultREAD_SIGNAL.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&
a(Error("READ_SIGNAL response invalid"))})};d.prototype._readLED=function(a){this._doRequestXML("GET","/CmdResultREAD_LED.cmd",null,function(b,c){b?a&&a(b):c&&c.State?a&&a(null,c.State):a&&a(Error("READ_LED response invalid"))})};d.prototype._readSerial=function(a){this._doRequest("GET","/CmdResultREAD_SERIALNR.cmd",null,function(b,c){a&&a(b,c)})};d.prototype._readName=function(a){this._doRequest("GET","/CmdResultREAD_NAME.cmd",null,function(b,c){a&&a(b,c)})};d.prototype._resetFilter=function(a){this._doRequest("POST",
"/CommandRESET_FILTER.cmd",null,function(b){a&&a(b)})};d.prototype._resetError=function(a){this._doRequest("POST","/CommandRESET_ERROR.cmd",null,function(b){a&&a(b)})};d.prototype._doRequestXML=function(a,b,c,d){var k=this;this._doRequest(a,b,c,function(a,b){a?d&&d(a):(a=null,b&&(a=k._xml2json(b)),d&&d(null,a))})};d.prototype._xml2json=function(a){var b=function(a){var c={};a.children().each(function(){var a=$(this),d=a.prop("tagName");a=0==a.children().length?a.text():b(a);c[d]=a});return c};try{var c=
$($.parseXML(a));var d=c.getRootNode?c.getRootNode():$(c.children()[0]);if(!d)return null;var g=d.prop("tagName"),e=b(d);a={};a[g]=e;return a}catch(f){return null}};d.prototype._doRequest=function(a,b,c,d){var g=this;b="http://"+this._ip+":"+this._port+b;this._logger.log("trace","send "+a+" to url:"+b+" data:"+c);var e=d;$.ajax({url:b,type:a,timeout:this._timeout,data:c,dataType:"text",cache:!1,username:this._username,password:this._password,success:function(a){g._logger.log("trace","http request success:"+
a);e&&(e(null,a),e=null)},error:function(a,b){a="http request error:"+(a?a.status:"0")+"-"+b;g._logger.log("trace",a);e&&(e(Error(a)),e=null)}})};d.prototype.toJSON=function(){return{sys:"gealan",ip:this._ip,port:this._port,username:this._username,password:this._password}};d.prototype.equalsTo=function(a){return a&&a instanceof d?this._ip==a._ip&&this._port==a._port:!1};d.parseJSON=function(a){return a&&a.ip?new d(a.ip,a.port,a.username,a.password):null};return d}();
xnm.aio.gealan.DM=function(){var g={command:[{type:"int",name:"set level",ref:{value:"setLevel",ext:"%d",extMeta:"0-5"}},{type:"enum",name:"automatic",ref:{value:"automatic"}},{type:"enum",name:"manual",ref:{value:"manual"}},{type:"enum",name:"next level",ref:{value:"nextLevel"}},{type:"enum",name:"previous level",ref:{value:"previousLevel"}},{type:"int",name:"set night in",ref:{value:"nightIn",ext:"%d",extMeta:"1-3"}},{type:"int",name:"set night out",ref:{value:"nightOut",ext:"%d",extMeta:"1-3"}},
{type:"enum",name:"reset filter",ref:{value:"resetFilter"}},{type:"enum",name:"reset error",ref:{value:"resetError"}}],status:[{type:"int",name:"temperature inside",ref:{value:"tempIn",ext:"%d"}},{type:"int",name:"temperature outside",ref:{value:"tempOut",ext:"%d"}},{type:"int",name:"humidity inside",ref:{value:"humIn",ext:"%d"}},{type:"int",name:"level",ref:{value:"level",ext:"%d",extMeta:"0-5"}},{type:"enum",name:"mode",ref:{value:"mode",options:"MANUAL AUTOMATIC NIGHT_IN NIGHT_OUT FLAP_CLOSED ERROR FROST_PROTECTION MOISTURE_PROTECTION".split(" ")}},
{type:"int",name:"state no.",ref:{value:"stateNr",ext:"%d",extMeta:"0-12"}},{type:"int",name:"state no. (internal)",ref:{value:"stateNrInt",ext:"%d"}},{type:"string",name:"error message",ref:{value:"error",ext:"%s"}},{type:"int",name:"error no.",ref:{value:"errorNr",ext:"%d"}},{type:"int",name:"night speed",ref:{value:"nightSpeed",ext:"%d",extMeta:"1-3"}},{type:"enum",name:"replace filter",ref:{value:"filterReplace",options:["true","false"]}},{type:"int",name:"log entries",ref:{value:"logEntries",
ext:"%d"}},{type:"int",name:"humidity no.",ref:{value:"humidityNr",ext:"%d"}},{type:"int",name:"freeze no.",ref:{value:"freezeNr",ext:"%d"}},{type:"int",name:"usage mode",ref:{value:"usageMode",ext:"%d"}},{type:"int",name:"night mode state",ref:{value:"nightModeState",ext:"%d"}},{type:"int",name:"temperature exhaust air (outside)",ref:{value:"temp1",ext:"%d"}},{type:"int",name:"temperature supply air (inside)",ref:{value:"temp2",ext:"%d"}},{type:"int",name:"temperature supply air (outside)",ref:{value:"temp3",
ext:"%d"}},{type:"int",name:"temperature exhaust air (inside)",ref:{value:"temp4",ext:"%d"}},{type:"int",name:"humidity supply air (outside)",ref:{value:"hum1",ext:"%d"}},{type:"int",name:"humidity exhaust air (inside)",ref:{value:"hum2",ext:"%d"}},{type:"int",name:"filter elapsed time",ref:{value:"elapsed",ext:"%d"}},{type:"int",name:"filter ramining time",ref:{value:"ramining",ext:"%d"}},{type:"int",name:"target rotation speed in",ref:{value:"targetRSIn",ext:"%d"}},{type:"int",name:"actual rotation speed in",
ref:{value:"currentRSIn",ext:"%d"}},{type:"int",name:"target rotation speed out",ref:{value:"targetRSOut",ext:"%d"}},{type:"int",name:"actual rotation speed out",ref:{value:"currentRSOut",ext:"%d"}},{type:"int",name:"max rotation speed",ref:{value:"maxRS",ext:"%d"}},{type:"int",name:"min rotation speed",ref:{value:"minRS",ext:"%d"}}]},d=function(a,b){this.code=a;this.message=b;this.stack=Error().stack};d.prototype=Error();d.prototype.name="GealanDMError";d.prototype.code=0;d.ERROR_CODE={DEFAULT:0,
INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6};return{SYS:"gealan",getIPDeviceType:function(){return[{sys:this.SYS,name:"Gealan Fan"}]},createDevice:function(a,b,c){b=d.ERROR_CODE;a?a.type?a.ip?c(null,a):c(new d(b.INVALID,"ip is invalid")):c(new d(b.INVALID,"type is invalid")):c(new d(b.INVALID,"info is invalid"))},updateDevice:function(a,b,c){b=d.ERROR_CODE;a?a.type?a.ip?c(null,a):c(new d(b.INVALID,"ip is invalid")):c(new d(b.INVALID,"type is invalid")):c(new d(b.INVALID,
"info is invalid"))},deleteDevice:function(a,b,c){c()},applyUIFilter:function(a,b,c){var d=this,g=function(a,b){if("*"==a)return!0;for(var c=!1,d=0;d<a.length;d++)if(a[d]==b){c=!0;break}return c},e=function(a,b,c){var d=[];switch(c.catagory){case "command":a.command&&a.command.forEach(function(a){g(c.elems,a.type)&&(a=JSON.parse(JSON.stringify(a)),d.push(a))});break;case "status":a.status&&a.status.forEach(function(a){g(c.elems,a.type)&&(a=JSON.parse(JSON.stringify(a)),d.push(a))})}return d},f=function(a,
b){var f=[],g=d.getCommandStatusMap(a,c);g&&(a=e(g,a,b),f=f.concat(a));return f};if(!a.sys)return null;var l=JSON.parse(JSON.stringify(a)),h=null;switch(b.catagory){case "command":h=f(a,b);l.command=h;break;case "status":h=f(a,b);l.status=h;break;default:return null}return h&&0!=h.length?l:null},getCommandStatusMap:function(a,b){return g}}}();
xnm.aio.gealan.Handler=function(){var g=function(){};g.prototype.devicemanager=xnm.aio.gealan.DM;g.prototype.Fan=xnm.aio.gealan.Fan;g.prototype.registModule=function(d){d.register("gealan","gealan")};g.prototype.resolveDevice=function(d){return this.Fan.parseJSON(d)};g.prototype.getDeviceCommands=function(d,a){d=(d=this.devicemanager.applyUIFilter(d,{catagory:"command",elems:"*"}))?d.command:[];a&&a(null,d)};g.prototype.getDeviceStatus=function(d,a){d=(d=this.devicemanager.applyUIFilter(d,{catagory:"status",
elems:"*"}))?d.status:[];a&&a(null,d)};g.prototype.doCommand=function(d,a,b){var c=this.resolveDevice(d);c?c.executeCommandCreator(d,a,function(a){b&&b(a)}):b&&b(Error("device json format invalid"))};g.prototype.doStatus=function(d,a,b,c){var g=this.resolveDevice(a);g?g.getStatesCreator(null,[{id:d,device:a,status:b}],function(a,b){a?c&&c(a):c&&c(null,b[0])}):c&&c(Error("device json format invalid"))};return g}();
"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new xnm.aio.gealan.Handler);
